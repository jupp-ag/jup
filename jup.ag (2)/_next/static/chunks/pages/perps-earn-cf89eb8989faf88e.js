(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8487],{39694:function(e,t,n){var r="__lodash_hash_undefined__",s="[object Function]",i="[object GeneratorFunction]",a=/^\[object .+?Constructor\]$/,o="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,c=o||l||Function("return this")();var u=Array.prototype,d=Function.prototype,p=Object.prototype,f=c["__core-js_shared__"],m=function(){var e=/[^.]+$/.exec(f&&f.keys&&f.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),x=d.toString,h=p.hasOwnProperty,v=p.toString,g=RegExp("^"+x.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),b=u.splice,w=T(c,"Map"),y=T(Object,"create");function j(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function k(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _(e,t){for(var n,r,s=e.length;s--;)if((n=e[s][0])===(r=t)||n!==n&&r!==r)return s;return-1}function N(e){if(!I(e)||(t=e,m&&m in t))return!1;var t,n=function(e){var t=I(e)?v.call(e):"";return t==s||t==i}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}(e)?g:a;return n.test(function(e){if(null!=e){try{return x.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e))}function S(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function T(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return N(n)?n:void 0}function A(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a),a};return n.cache=new(A.Cache||k),n}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}j.prototype.clear=function(){this.__data__=y?y(null):{}},j.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},j.prototype.get=function(e){var t=this.__data__;if(y){var n=t[e];return n===r?void 0:n}return h.call(t,e)?t[e]:void 0},j.prototype.has=function(e){var t=this.__data__;return y?void 0!==t[e]:h.call(t,e)},j.prototype.set=function(e,t){return this.__data__[e]=y&&void 0===t?r:t,this},P.prototype.clear=function(){this.__data__=[]},P.prototype.delete=function(e){var t=this.__data__,n=_(t,e);return!(n<0)&&(n==t.length-1?t.pop():b.call(t,n,1),!0)},P.prototype.get=function(e){var t=this.__data__,n=_(t,e);return n<0?void 0:t[n][1]},P.prototype.has=function(e){return _(this.__data__,e)>-1},P.prototype.set=function(e,t){var n=this.__data__,r=_(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},k.prototype.clear=function(){this.__data__={hash:new j,map:new(w||P),string:new j}},k.prototype.delete=function(e){return S(this,e).delete(e)},k.prototype.get=function(e){return S(this,e).get(e)},k.prototype.has=function(e){return S(this,e).has(e)},k.prototype.set=function(e,t){return S(this,e).set(e,t),this},A.Cache=k,e.exports=A},8770:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(57565),s=n(55540),i=n(21382),a=function(e,t){var n=new r.Y7(t,e,{commitment:"processed",skipPreflight:!0});return new r.$r(s.x,i.KX,n)}},6901:function(e,t,n){"use strict";n.d(t,{b:function(){return a},y:function(){return i}});var r=n(13838),s=n(39694),i=n.n(s)()((function(e){if(!e)return 4;var t=new r.Z(e);return t.gte(100)?2:t.gte(10)?3:4})),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:365,n=e.div(100).div(t).add(1).pow(t).sub(1).mul(100);return n}},33130:function(e,t,n){"use strict";n.d(t,{R3:function(){return k}});var r,s=n(54423),i=n(63956),a=n(70107),o=n(27195),l=n(8857),c=n.n(l),u=n(73360),d=n(7761),p=n(93981),f=n(65838),m=n(96343),x=n(50992),h=n(17463),v=n(57917),g=n(90342),b=n(14167),w=n(29541),y=["title","description"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.NONE="NONE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.VERY_HIGH="VERY_HIGH",e.UNSAFE_MAX="UNSAFE_MAX",e.DEFAULT="DEFAULT"}(r||(r={}));var k=function(){var e=(0,m.lm)().toast,t=(0,f.Rc)(),n=(0,f.Os)(),r=(0,v.SR)(),i=r.addNotificationTx,l=r.updateNotificationMetadata,j=r.updateNotificationTxStatus,k=(0,g.gs)().modifyComputeUnitPriceAndLimit,_=(0,p.useCallback)(function(){var r=(0,o.Z)(c().mark((function r(p,f,m){var v,g,_,N,S,T,A,I,M,R,Z,C,L,E,O,V,B,K,D;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(g=f.extraSigners,_=f.blockhash,N=f.lastValidBlockHeight,S=f.idl,T=f.idlProgramId,A=f.skipPreflight,n.publicKey&&n.signTransaction){r.next=3;break}throw new Error("Wallet not connected");case 3:return I="",M=void 0,r.next=7,k(p,{minimumFee:m.minimumFee,referenceFee:m.referenceFee,requestComputeBudgetLimit:m.requestComputeBudgetLimit});case 7:return R=null!==(v=m.toastId)&&void 0!==v?v:(0,b.w)(),r.prev=8,Z=m.submittingMessage,r.prev=10,g&&("version"in p?p.sign(g):(C=p).sign.apply(C,(0,a.Z)(g))),e({duration:6e4,id:R,render:function(e){return(0,w.jsx)(h.x,P({},e))},closeOnClick:!1}),i(R,{status:"loading",txid:I,stepText:d.ag._("Pending wallet to sign")}),r.next=16,n.signTransaction(p);case 16:p=r.sent,r.next=25;break;case 19:return r.prev=19,r.t0=r.catch(10),i(R,{status:"fail-no-txid",txid:"",stepText:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{children:r.t0.message}),(0,w.jsx)(u.cC,{id:"Refresh browser if problem persists"})]}),error:r.t0}),l(R,{customTitle:d.ag._("Wallet signing failed")}),e({duration:5e3,id:R,render:function(e){return(0,w.jsx)(h.x,P({},e))},closeOnClick:!1}),r.abrupt("return",{success:!1,error:r.t0});case 25:return I=(0,x.o$)(p),i(R,{status:"loading",txid:I,stepText:Z}),L=!1,r.next=30,new Promise(function(){var n=(0,o.Z)(c().mark((function n(r,s){var i,a,o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.confirmTransaction({signature:I,blockhash:_,lastValidBlockHeight:N},"processed").then((function(e){L||e.value.err||(j(R,{status:"processed",txid:I,stepText:Z}),m.autoResolveOnProcessed&&setTimeout((function(){return r({success:!1,status:"unknown",txid:I})}),1e3))})),e({duration:6e4,id:R,render:function(e){return(0,w.jsx)(h.x,P({},e))},closeOnClick:!1}),m.onSending&&m.onSending(),n.next=5,(0,x.ie)({connection:t,blockhash:_,lastValidBlockHeight:N,idl:S,idlProgramId:T,signedTransaction:p,skipPreflight:null===A||void 0===A||A});case 5:if(M=n.sent,L=!0,!("error"in M)){n.next=9;break}return n.abrupt("return",s(M.error));case 9:if(!("resolveSuccessTitleAndDescription"in m)){n.next=15;break}return n.next=12,m.resolveSuccessTitleAndDescription(M.transactionResponse,M.txid).catch((function(e){return console.error(e),{title:d.ag._("Transaction success"),description:""}}));case 12:n.t0=n.sent,n.next=16;break;case 15:n.t0={title:m.successMessage,description:""};case 16:return i=n.t0,a=i.title,o=i.description,l(R,{customTitle:a,description:o}),j(R,{status:"success",stepText:null}),n.abrupt("return",r({success:!0,txid:I,transactionResponse:M.transactionResponse}));case 22:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}());case 30:if(!("error"in(E=r.sent))){r.next=33;break}throw E;case 33:return r.abrupt("return",E);case 36:return r.prev=36,r.t1=r.catch(8),O=d.ag._("Transaction failed"),r.t1 instanceof x.qw&&(O=r.t1.message),V="resolveErrorTitleAndDescription"in m?m.resolveErrorTitleAndDescription(r.t1,M):{title:m.errorMessage,description:O},B=V.title,K=V.description,D=(0,s.Z)(V,y),l(R,P({customTitle:B,description:K},D)),r.t1.txid?j(R,{status:"fail",error:r.t1,stepText:""}):j(R,{status:"fail-no-txid",error:r.t1,stepText:""}),console.error({error:r.t1,isTxError:r.t1 instanceof x.qw}),r.abrupt("return",{success:!1,txid:I,error:r.t1});case 45:case"end":return r.stop()}}),r,null,[[8,36],[10,19]])})));return function(e,t,n){return r.apply(this,arguments)}}(),[n,t,i,e,l,j,k]);return _}},71932:function(e,t,n){"use strict";var r=n(63956),s=n(54423),i=(n(93981),n(29541)),a=["width","height"];function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.width,n=void 0===t?"12":t,r=e.height,o=void 0===r?"12":r,c=(0,s.Z)(e,a);return(0,i.jsx)("svg",l(l({width:n,height:o,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c),{},{children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM9.93793 12.1728C9.47107 12.1733 9.08835 11.8037 9.07186 11.3372L8.86888 5.61643C8.86042 5.3813 8.94838 5.15338 9.11162 4.98422C9.27485 4.81507 9.49982 4.71992 9.73494 4.71992H10.1409C10.376 4.71992 10.601 4.81507 10.7642 4.98422C10.9275 5.15338 11.0154 5.38131 11.007 5.61643L10.804 11.3372C10.7875 11.8037 10.4048 12.1733 9.93793 12.1728ZM9.93783 15.4176C10.6106 15.4176 11.1557 14.8725 11.1557 14.1997C11.1557 13.5269 10.6106 12.9818 9.93783 12.9818C9.26502 12.9818 8.71992 13.5269 8.71992 14.1997C8.71992 14.8725 9.26502 15.4176 9.93783 15.4176Z",fill:"currentColor"})}))}},80787:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return Me},default:function(){return Re}});var r=n(93981),s=n(19424),i=n(97620),a=n(70107),o=n(7761),l=n(65838),c=n(96343),u=n(12197),d=n(43231),p=n(13838),f=n(21382),m=n(74518),x=n(56100),h=n(6901),v=n(29541),g=function(e){var t=e.custody,n=e.totalPoolValue,s=(0,f.tc)(),i=s.perpsTokens,o=s.oraclePrices,l=(0,r.useMemo)((function(){return[].concat((0,a.Z)(i.nonStableTokens),(0,a.Z)(i.stableTokens)).find((function(e){return e.address===t.account.mint.toBase58()}))}),[t,i]),c=(0,r.useMemo)((function(){var e;return o&&(null===(e=o[t.account.mint.toString()])||void 0===e?void 0:e.buyLp)}),[t,o]),d=(0,r.useMemo)((function(){if(c){var e=t.account.assets.owned,r=new p.Z(c).mul(e.toString()).div(Math.pow(10,t.account.decimals)).toDP(2),s=r.gt(0)?r.div(n).mul(100).toNearest(.01,p.Z.ROUND_UP).toNumber():0,i=e.gtn(0)&&t.account.assets.locked.gtn(0)?new p.Z(t.account.assets.locked.toString()).div(e.toString()).mul(1e4):new p.Z(0);return{tokenAmount:e,poolValue:r.toNumber(),weightage:Math.min(s,100),utilizationBps:i}}}),[t,c,n]),g=null!==d&&void 0!==d&&d.utilizationBps?"".concat(new p.Z(d.utilizationBps.toString()).div(100).toDP(2),"%"):"",b=(0,r.useMemo)((function(){if(!d||!o||!l)return null;var e=new p.Z(d.tokenAmount.toString()).div(Math.pow(10,t.account.decimals)),n=(0,h.y)(e);return u.uf.format(e.toString(),n)}),[t,d,o,l]);return(0,v.jsxs)("div",{className:"flex flex-row w-full overflow-hidden",children:[(0,v.jsx)("div",{className:"w-full flex flex-row items-center min-w-[150px]",children:(0,v.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,v.jsx)("div",{className:"!min-h-[24px] !min-w-[24px] flex items-center",children:(0,v.jsx)(m.Z,{info:l,width:24,height:24})}),l?(0,v.jsxs)("div",{className:"space-y-1",children:[(0,v.jsx)("p",{className:"text-sm text-white",children:null===l||void 0===l?void 0:l.symbol}),(0,v.jsx)("p",{className:"text-xs text-white/30",children:null===l||void 0===l?void 0:l.name})]}):(0,v.jsx)(x.O,{className:"!h-10 !w-20"})]})}),(0,v.jsx)("div",{className:"w-full min-w-[222px] flex flex-row items-center justify-center",children:(0,v.jsx)("div",{className:"p-4 flex flex-col justify-center items-center",children:d?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("p",{className:"text-white text-xs",children:["$",u.uf.format(d.poolValue)]}),(0,v.jsxs)("p",{className:"text-white/30 text-xs",children:[b," ",null===l||void 0===l?void 0:l.symbol]})]}):(0,v.jsx)(x.O,{className:"!h-6 !w-40"})})}),(0,v.jsx)("div",{className:"w-full flex flex-row justify-center items-center min-w-[186px]",children:(0,v.jsx)("div",{children:d?(0,v.jsx)("span",{className:"text-white/70 text-xs",children:"".concat((null===d||void 0===d?void 0:d.weightage)||0,"% / ").concat(t.account.targetRatioBps.toNumber()/100,"%")}):(0,v.jsx)(x.O,{className:"!h-6 !w-20"})})}),(0,v.jsx)("div",{className:"w-full flex flex-row items-center min-w-[82px] justify-end",children:g?(0,v.jsx)("span",{className:"text-white/70 text-xs w-14 text-center",children:g}):(0,v.jsx)(x.O,{className:"!h-6 !w-12"})})]})},b=n(22663),w=n(35569),y=n(40558),j=n(68586),P=n(7094),k=function(e){var t=e.background,n=e.shadow,r=e.children;return(0,v.jsx)("div",{style:{overflow:"auto",backgroundImage:["linear-gradient(to right, ".concat(t,", ").concat(t,")"),"linear-gradient(to right, ".concat(t,", ").concat(t,")"),"linear-gradient(to right, ".concat(n,", rgba(255, 255, 255, 0))"),"linear-gradient(to left, ".concat(n,", rgba(255, 255, 255, 0))")].join(","),backgroundPosition:"left center, right center, left center, right center",backgroundRepeat:"no-repeat",backgroundColor:t,backgroundSize:"10px 100%, 10px 100%, 10px 100%, 10px 100%",backgroundAttachment:"local, local, scroll, scroll"},children:r})},_=n(64508),N=n.n(_),S=n(24628),T=n(99438),A=n(27195),I=n(8857),M=n.n(I),R=n(73360),Z=n(65558),C=n.n(Z),L=n(39268),E=n.n(L),O=n(71048),V=n(89388),B=n(12939),K=n(85394),D=n(1622),F=n(13170),q=n(94223),U=n(9319),W=n.n(U),H=n(72466),G=n(14640),$=n(24684),z=n(71932),Y=n(6397),J=n(36232),X=n(57565),Q=n(67982),ee=n(8770),te=function(){var e=(0,A.Z)(M().mark((function e(t,n){var r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMultipleAccountsInfo(n.map((function(e){return new d.PublicKey(e)})));case 2:return r=e.sent,e.abrupt("return",r.reduce((function(e,t,r){var s=n[r];if(t){var i=new d.AddressLookupTableAccount({key:new d.PublicKey(s),state:d.AddressLookupTableAccount.deserialize(t.data)});e.push(i)}return e}),new Array));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ne=n(50992);function re(e){return se.apply(this,arguments)}function se(){return(se=(0,A.Z)(M().mark((function e(t){var n,r,s,o,l,c,u,p,m,x,h,v,g,b,w,y,j,P,k,_,N,S,T,A,I,R,Z,C,L,E;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lpTokenMint,r=t.wallet,s=t.publicKey,o=t.connection,l=t.custody,c=t.payAmount,u=t.minReceiveAmount,p=t.originalTokenAmount,m=t.custodyMetas,x=t.getSwapIx,h=t.blockhash,e.prev=1,v=(0,ee.h)(r,o),e.next=5,(0,ne.c1)(n,s,o);case 5:return g=e.sent,b=(0,i.Z)(g,2),w=b[0],y=b[1],e.next=11,(0,ne.c1)(l.account.mint,s,o);case 11:if(j=e.sent,P=(0,i.Z)(j,2),k=P[0],_=P[1],N=[],y&&N.push(y),_&&N.push(_),!l.account.mint.equals(F.W4)||x){e.next=23;break}return e.next=21,o.getBalance(k);case 21:S=e.sent,c.gt(new X.BN(S))&&(N.push(d.SystemProgram.transfer({fromPubkey:s,toPubkey:k,lamports:BigInt(c.toString())})),N.push(Q.Token.createSyncNativeInstruction(Q.TOKEN_PROGRAM_ID,k)));case 23:return e.next=25,v.methods.addLiquidity({tokenAmountIn:c,minLpAmountOut:u,tokenAmountPreSwap:p}).accounts({owner:s,fundingAccount:k,lpTokenAccount:w,transferAuthority:f.oW,perpetuals:f.TJ,pool:f.FW,custody:l.publicKey,custodyOracleAccount:l.account.oracle.oracleAccount,custodyTokenAccount:l.account.tokenAccount,lpTokenMint:n,tokenProgram:Q.TOKEN_PROGRAM_ID}).remainingAccounts(m).instruction();case 25:return T=e.sent,A=[d.ComputeBudgetProgram.setComputeUnitLimit({units:14e5})].concat(N),e.t0=a.Z,e.next=30,te(o,[f.vN]);case 30:if(e.t1=e.sent,I=(0,e.t0)(e.t1),!x){e.next=42;break}return e.next=35,x({userPublicKey:s});case 35:R=e.sent,Z=R.swapInstruction,C=R.addressLookupTableAccounts,I.push.apply(I,(0,a.Z)(C)),A.push(Z,T),e.next=43;break;case 42:A.push(T);case 43:return L=new d.TransactionMessage({payerKey:s,recentBlockhash:h,instructions:A}).compileToV0Message(I),E=new d.VersionedTransaction(L),e.abrupt("return",E);case 48:throw e.prev=48,e.t2=e.catch(1),console.log(e.t2),e.t2;case 52:case"end":return e.stop()}}),e,null,[[1,48]])})))).apply(this,arguments)}function ie(e){return ae.apply(this,arguments)}function ae(){return(ae=(0,A.Z)(M().mark((function e(t){var n,r,s,o,l,c,u,p,m,x,h,v,g,b,w,y,j,P,k,_,N,S,T,A,I,R,Z,C,L,E;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lpTokenMint,r=t.wallet,s=t.publicKey,o=t.connection,l=t.custody,c=t.payAmount,u=t.minReceiveAmount,p=t.custodyMetas,m=t.shouldCloseLpTokenAccount,x=t.getSwapIx,h=t.blockhash,e.prev=1,v=(0,ee.h)(r,o),e.next=5,(0,ne.c1)(n,s,o);case 5:return g=e.sent,b=(0,i.Z)(g,1),w=b[0],e.next=10,(0,ne.c1)(l.account.mint,s,o);case 10:return y=e.sent,j=(0,i.Z)(y,2),P=j[0],k=j[1],_=[],k&&_.push(k),N=[],m&&N.push(Q.Token.createCloseAccountInstruction(Q.TOKEN_PROGRAM_ID,w,s,s,[])),l.account.mint.equals(F.W4)&&N.push(Q.Token.createCloseAccountInstruction(Q.TOKEN_PROGRAM_ID,P,s,s,[])),e.next=21,v.methods.removeLiquidity({lpAmountIn:c,minAmountOut:u}).accounts({owner:s,receivingAccount:P,lpTokenAccount:w,transferAuthority:f.oW,perpetuals:f.TJ,pool:f.FW,custody:l.publicKey,custodyOracleAccount:l.account.oracle.oracleAccount,custodyTokenAccount:l.account.tokenAccount,lpTokenMint:n,tokenProgram:Q.TOKEN_PROGRAM_ID}).remainingAccounts(p).instruction();case 21:return S=e.sent,T=[d.ComputeBudgetProgram.setComputeUnitLimit({units:14e5})].concat(_),e.t0=a.Z,e.next=26,te(o,[f.vN]);case 26:if(e.t1=e.sent,A=(0,e.t0)(e.t1),!x){e.next=39;break}return e.next=31,x({userPublicKey:s});case 31:I=e.sent,R=I.swapInstruction,Z=I.tokenLedgerInstruction,C=I.addressLookupTableAccounts,A.push.apply(A,(0,a.Z)(C)),T.push(Z,S,R),e.next=40;break;case 39:T.push(S);case 40:return T.push.apply(T,N),L=new d.TransactionMessage({payerKey:s,recentBlockhash:h,instructions:T}).compileToV0Message(A),E=new d.VersionedTransaction(L),e.abrupt("return",E);case 46:throw e.prev=46,e.t2=e.catch(1),console.log(e.t2),e.t2;case 50:case"end":return e.stop()}}),e,null,[[1,46]])})))).apply(this,arguments)}var oe=n(31781),le=n(90342),ce=n(795).Buffer,ue=function(e){var t=e.fromPairValue,n=e.fromPairTokenInfo,s=(0,le.gs)().prioritizationFeeLamports,a=(0,l.Bn)(),c=a.connection,m=a.getTokenInfo,x=(0,f.tc)(),h=x.perpsTokens,v=x.oraclePrices,g=x.poolInfo,b=x.custodies,w=(0,r.useMemo)((function(){if(v&&g){var e=b.map((function(e){var t=e.account,n=t.mint,r=t.assets,s=t.decimals,i=t.targetRatioBps,a=v[n.toString()];if(!a)return null;var o=r.owned,l=new p.Z(a.buyLp).mul(o.toString()).div(Math.pow(10,s)).toDP(2),c=l.gt(0)?l.div(g.poolAumUsd).mul(100).toNearest(.01,p.Z.ROUND_DOWN).toNumber():0;return{mint:n.toString(),weightage:new p.Z(i.toString()).sub(100*c)}})).filter(Boolean).sort((function(e,t){return t.weightage.toNumber()-e.weightage.toNumber()}));return 0===e.length?null:m(e[0].mint)}}),[v,g,b,m]),y=(0,r.useMemo)((function(){var e=Object.values(h).flat();return!Boolean(e.find((function(e){return e.address===n.address})))}),[n.address,h]),j=(0,r.useMemo)((function(){return(0,u.Hd)(t)?W().BigInt(new p.Z(t).mul(Math.pow(10,n.decimals)).round().toFixed()||0):W().BigInt(0)}),[t,n.decimals]),P=(0,oe.OO)({amount:j,inputMint:n&&y?new d.PublicKey(n.address):void 0,outputMint:w&&y?new d.PublicKey(w.address):void 0,slippageBps:1e4,maxAccounts:45}),k=P.quoteResponseMeta,_=P.loading,N=P.error,S=P.refresh,T=(0,r.useCallback)(function(){var e=(0,A.Z)(M().mark((function e(t){var r,a,o,l,u,p,f,m,x,h,v,b,y,j;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userPublicKey,e.prev=1,k&&w&&g){e.next=4;break}throw new Error("Invalid quote response");case 4:return e.next=6,(0,ne.c1)(new d.PublicKey(n.address),r,c);case 6:return o=e.sent,l=(0,i.Z)(o,1),u=l[0],e.next=11,(0,ne.c1)(new d.PublicKey(w.address),r,c);case 11:return p=e.sent,f=(0,i.Z)(p,1),m=f[0],x={quoteResponse:k.original,userPublicKey:r.toBase58(),wrapAndUnwrapSol:!1,prioritizationFeeLamports:s,sourceTokenAccount:u,destinationTokenAccount:m},e.next=17,fetch("https://quote-api.jup.ag/v6/swap-instructions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});case 17:return e.next=19,e.sent.json().catch(function(){var e=(0,A.Z)(M().mark((function e(t){var n,r,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,r=n.error,s=n.message,e.abrupt("return",{error:new ne.qw(s,void 0,r)});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:if(!("error"in(a=e.sent))){e.next=22;break}throw new Error(a.error.message);case 22:return v=(h=a).swapInstruction,b=h.addressLookupTableAddresses,y=new d.TransactionInstruction({programId:new d.PublicKey(v.programId),keys:v.accounts.map((function(e){return{pubkey:new d.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ce.from(v.data,"base64")}),e.next=26,te(c,b);case 26:return j=e.sent,e.abrupt("return",{swapInstruction:y,addressLookupTableAccounts:j});case 30:throw e.prev=30,e.t0=e.catch(1),e.t0;case 33:case"end":return e.stop()}}),e,null,[[1,30]])})));return function(t){return e.apply(this,arguments)}}(),[w,s,c,n.address,g,k]),I=(0,r.useMemo)((function(){return null===k||void 0===k?void 0:k.quoteResponse.outAmount}),[k]),R=(0,r.useMemo)((function(){if(y&&N)return o.ag._("We're having trouble finding route for this trade. Please try again with different amount or other token.")}),[N,y]);return{isLoading:_,quoteResponseMeta:k,basketTokenWithLowestFee:w,isTokenSwapRequired:y,outAmount:I,getSwapIx:T,hasJupiterError:R,refresh:S}},de=n(94107),pe=n(3011),fe=n(41264),me=n(33130),xe=n(49839),he=n(55540),ve=n(85653),ge=function(e){var t=e.onClick,n=e.label,r=e.isActive;return(0,v.jsx)("button",{type:"button",onClick:t,className:(0,V.cn)("flex flex-row items-center justify-center px-3 py-4 font-semibold border-b",r?"border-b-labs text-labs":"border-transparent"),children:(0,v.jsx)("span",{className:"text-sm",children:n})})},be=function(e){var t=e.refresh,n=e.action,r=e.setAction,s=e.isLoading;return(0,v.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-4 px-4 border-b-white/5 border-b h-[56px]",children:[(0,v.jsxs)("div",{className:"flex flex-row w-full",children:[(0,v.jsx)(ge,{isActive:"viaSwap"===n,label:o.ag._("Trade"),onClick:function(){return r("viaSwap")}}),(0,v.jsx)(ge,{isActive:"buy"===n,label:o.ag._("Buy"),onClick:function(){return r("buy")}}),(0,v.jsx)(ge,{isActive:"sell"===n,label:o.ag._("Sell"),onClick:function(){return r("sell")}})]}),t&&(0,v.jsx)("div",{className:"flex items-center h-7",children:(0,v.jsx)(ve.Z,{isLoading:s,refresh:t})})]})};function we(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw i}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var je=E()((function(){return n.e(4642).then(n.bind(n,64642))}),{ssr:!1,loadableGenerated:{webpack:function(){return[64642]}}}),Pe=function(e){var t=e.action,n=e.setAction,s=(0,l.Bn)(),m=s.connection,x=s.getTokenInfo,h=s.tokens,g=(0,l.Os)(),w=g.wallet,y=g.signTransaction,j=(0,l.C9)(),k=(0,f.tc)(),_=k.viewClient,N=k.refreshViews,S=k.poolInfo,I=k.slippage,Z=k.perpsTokens,L=k.custodies,E=(0,P.Z)(),U=E.availableAUMQuotas,X=E.availableDepositQuotas,Q=(0,me.R3)(),ee=(0,pe.KO)(xe.yz),te=(0,i.Z)(ee,1)[0],se=(0,le.gs)().priorityLevel,ie=(0,O.cI)({defaultValues:{fromPair:Y.Lr.toString(),fromPairValue:"",toPair:"",toPairValue:"",feeBps:""}}),ae=ie.control,oe=ie.handleSubmit,ce=ie.watch,ve=ie.setValue,ge=ie.formState,ye=ce(),Pe=(0,r.useMemo)((function(){return x(ye.fromPair)||Y.Zt}),[x,ye.fromPair]),ke=(0,r.useMemo)((function(){return(null===S||void 0===S?void 0:S.lpTokenInfo)||Y.Zt}),[S]);(0,r.useEffect)((function(){ve("fromPair",Pe.address)}),[Pe,ve]);var _e=ue({fromPairValue:ye.fromPairValue,fromPairTokenInfo:Pe}),Ne=_e.isLoading,Se=_e.quoteResponseMeta,Te=_e.basketTokenWithLowestFee,Ae=_e.isTokenSwapRequired,Ie=_e.outAmount,Me=_e.getSwapIx,Re=_e.hasJupiterError,Ze=_e.refresh,Ce=(0,r.useMemo)((function(){return _&&Te?{poolCustodyAccount:Ae?L.find((function(e){return e.account.mint.toBase58()===Te.address})):L.find((function(e){return e.account.mint.toBase58()===Pe.address}))}:{poolCustodyAccount:null}}),[_,Te,Ae,L,Pe.address]).poolCustodyAccount,Le=(0,c.FB)(ye.fromPair,Pe.decimals).balance,Ee=(0,r.useCallback)((function(e){var t;e.preventDefault(),t=ye.fromPair===F.W4.toBase58()?String(Le>F.WO?Le-F.WO:0):String(Le),ve("fromPairValue",t)}),[Le,ye.fromPair,ve]),Oe=(0,r.useMemo)((function(){if(null===w||void 0===w||!w.adapter.connected)return!1;if((null===Pe||void 0===Pe?void 0:Pe.address)!==F.W4.toBase58())return!1;if(!(0,u.Hd)(ye.fromPairValue))return!1;var e=Le-F.WO;return new p.Z(ye.fromPairValue||0).gt(e)}),[null===Pe||void 0===Pe?void 0:Pe.address,Le,null===w||void 0===w?void 0:w.adapter.connected,ye.fromPairValue]),Ve=(0,r.useMemo)((function(){return Number(ye.fromPairValue)>Le}),[Le,ye.fromPairValue]),Be=(0,r.useMemo)((function(){return U.lt(0)}),[U]),Ke=(0,r.useMemo)((function(){return X.lt(new p.Z(ye.toPairValue||0))}),[X,ye.toPairValue]),De=(0,l.iG)(),Fe=(0,r.useMemo)((function(){var e,t=null===(e=De.account)||void 0===e?void 0:e.account.lamports;return!t||t<F.WO}),[De.account]),qe=(0,r.useMemo)((function(){return Fe||Ve||ge.isSubmitting||!ye.toPairValue||Ke||Oe||Boolean(Re)}),[Fe,Ve,ge.isSubmitting,ye.toPairValue,Ke,Oe,Re]),Ue=(0,r.useMemo)((function(){return ye.toPairValue&&(0,u.Hd)(ye.toPairValue)?new(C())(new p.Z(ye.toPairValue).mul(Math.pow(10,ke.decimals)).mul(100-I).div(100).toDP(0).toFixed()):new(C())(0)}),[ye.toPairValue,ke.decimals,I]),We=r.useCallback(function(){var e=(0,A.Z)(M().mark((function e(t){var n,r,s,a,l,c,u,x,h,v,g,P;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fromPairValue,r=t.toPairValue,!qe&&_&&null!==w&&void 0!==w&&w.adapter.publicKey&&n&&r&&S&&!Ue.eqn(0)&&Ce&&y){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,w.adapter.publicKey){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,m.getLatestBlockhash("confirmed");case 8:if(s=e.sent,a=s.blockhash,l=s.lastValidBlockHeight,c={lpTokenMint:new d.PublicKey(S.lpMint),wallet:w,publicKey:w.adapter.publicKey,connection:m,custody:Ce,minReceiveAmount:Ue,custodyMetas:_.getCustodyMetas(),getSwapIx:null,blockhash:a,originalTokenAmount:null,payAmount:new(C())(0)},!Ae){e.next=39;break}if(c.payAmount=new(C())(0),c.getSwapIx=Me,Te){e.next=17;break}throw new Error("can't find basketTokenWithLowestFee");case 17:return e.next=19,(0,ne.c1)(new d.PublicKey(Te.address),w.adapter.publicKey,m);case 19:if(u=e.sent,x=(0,i.Z)(u,2),h=x[0],!x[1]){e.next=27;break}c.originalTokenAmount=new(C())(0),e.next=37;break;case 27:return e.prev=27,e.next=30,m.getTokenAccountBalance(h,"confirmed");case 30:v=e.sent,c.originalTokenAmount=new(C())(v.value.amount),e.next=37;break;case 34:throw e.prev=34,e.t0=e.catch(27),new Error("Failed to get userATA balance");case 37:e.next=42;break;case 39:c.payAmount=new(C())(new p.Z(n).mul(Math.pow(10,Pe.decimals)).toFixed()),c.originalTokenAmount=null,c.getSwapIx=null;case 42:return e.next=44,re(c);case 44:return g=e.sent,e.next=47,Q(g,{blockhash:a,lastValidBlockHeight:l,idl:he.x,idlProgramId:f.KX,skipPreflight:!0},{submittingMessage:o.ag._("Providing liquidity into {PERPS_LP_TICKER} pool with {fromPairValue} {0} for {toPairValue} {1}",{0:Pe.symbol,1:ke.symbol,PERPS_LP_TICKER:b.t,fromPairValue:n,toPairValue:r}),successMessage:o.ag._("Successfully spent {fromPairValue} {0} for {toPairValue} {1}",{0:Pe.symbol,1:ke.symbol,fromPairValue:n,toPairValue:r}),errorMessage:o.ag._("Failed to buy into {PERPS_LP_TICKER} pool.",{PERPS_LP_TICKER:b.t}),referenceFee:te.isOutdated?null:"MEDIUM"===se?te.claim:"HIGH"===se&&te.claim?1.5*te.claim:"VERY_HIGH"===se&&te.claim?3*te.claim:void 0,minimumFee:xe.uo,requestComputeBudgetLimit:15e4});case 47:if(!("error"in(P=e.sent))){e.next=50;break}throw P.error;case 50:ve("fromPairValue",""),ve("toPairValue",""),e.next=57;break;case 54:e.prev=54,e.t1=e.catch(3),console.error("Failed to buy into LP pool",e.t1);case 57:return e.prev=57,j(),N(),e.finish(57);case 61:case"end":return e.stop()}}),e,null,[[3,54,57,61],[27,34]])})));return function(t){return e.apply(this,arguments)}}(),[qe,_,w,S,Ue,Ce,y,m,Ae,Q,Pe.symbol,Pe.decimals,ke.symbol,ve,Me,Te,te.isOutdated,te.claim,se,j,N]),He=(0,r.useCallback)((function(e){ve("fromPair",e.address.toString()),ve("fromPairValue","")}),[ve]),Ge=r.useMemo((function(){if(ye.fromPairValue&&ye.toPairValue){if(Ve||Fe||Oe)return o.ag._("Insufficient {0}",{0:Fe?"SOL":Pe.symbol});if(Ke)return o.ag._("Buy Limit Exceeded");if(ge.isSubmitting)return(0,v.jsxs)("span",{className:"flex justify-center items-center",children:[(0,v.jsx)(K.Z,{className:"!h-4 !w-4",baseColor:"white",spinnerColor:"black"}),(0,v.jsx)("div",{className:"mr-2"}),o.ag._("Buying {PERPS_LP_TICKER}",{PERPS_LP_TICKER:b.t})]})}return(0,v.jsx)(B.Z,{children:(0,v.jsx)(R.cC,{id:"Buy"})})}),[ge.isSubmitting,Pe.symbol,Ve,Fe,Ke,Oe,ye.fromPairValue,ye.toPairValue]),$e=(0,r.useMemo)((function(){var e;return Boolean(null===w||void 0===w||null===(e=w.adapter.supportedTransactionVersions)||void 0===e?void 0:e.has(0))}),[null===w||void 0===w?void 0:w.adapter.supportedTransactionVersions]),ze=(0,r.useMemo)((function(){if(null!==w&&void 0!==w&&w.adapter.connected&&!$e)return[].concat((0,a.Z)(Z.nonStableTokens),(0,a.Z)(Z.stableTokens)).map((function(e){return e.address}));var e,t=[],n=we(h);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.address!==(null===S||void 0===S?void 0:S.lpTokenInfo.address)&&t.push(r.address)}}catch(s){n.e(s)}finally{n.f()}return t}),[Z.nonStableTokens,Z.stableTokens,null===S||void 0===S?void 0:S.lpTokenInfo.address,h,$e,null===w||void 0===w?void 0:w.adapter.connected]),Ye=(0,r.useState)(!1),Je=Ye[0],Xe=Ye[1],Qe=(0,r.useState)(""),et=Qe[0],tt=Qe[1],nt=(0,r.useState)((new Date).getTime()),rt=nt[0],st=nt[1],it=(0,r.useMemo)((function(){return Ae&&Ne||Je}),[Ne,Ae,Je]);(0,$.Gl)(it||!Ae||null===Se||void 0===Se?void 0:Se.quoteResponse,Pe.address,(null===Te||void 0===Te?void 0:Te.address)||"");var at=(0,G.Z)({selectedRoute:Se,hasEnoughSOL:!Fe}).errors,ot=(0,r.useMemo)((function(){var e=[];return Oe&&e.push(o.ag._("We recommend having at least {MINIMUM_SOL_BALANCE} SOL for any transaction",{MINIMUM_SOL_BALANCE:F.WO})),e}),[Oe]),lt=(0,r.useCallback)((function(){if(!_||!ye.fromPairValue||!(0,u.Hd)(ye.fromPairValue)||!Pe.address||!Ce)return ve("toPairValue",""),ve("feeBps",""),void tt("");if(Xe(!0),!(Ae?Te:Pe))throw new Error("tokenInfoToUse is null");var e=Ae?Ie?new(C())(Ie.toString()):null:new(C())(new p.Z(ye.fromPairValue).mul(Math.pow(10,Pe.decimals)).toDP(0).toFixed());e&&!e.eqn(0)&&_.getAddLiquidityAmountAndFee(Ce,e).then((function(e){e?(ve("toPairValue",new p.Z(e.amount.toString()).div(1e6).toString()),ve("feeBps",e.feeBps.toString()),tt("")):(ve("toPairValue",""),ve("feeBps",""),tt(o.ag._("Due to imbalance ratio of pool, please try a different token, or amount.")))})).catch(console.log).finally((function(){st((new Date).getTime()),Xe(!1)}))}),[Te,Pe,Ae,Ie,Ce,ve,_,ye.fromPairValue]);(0,r.useEffect)((function(){Ae?Se&&lt():lt()}),[ye.fromPairValue,Pe.address,I,Se]);var ct=(0,r.useMemo)((function(){return ye.feeBps&&ye.fromPairValue&&ye.toPairValue?"".concat(new p.Z(ye.feeBps).div(100).toString(),"%"):""}),[ye.feeBps,ye.fromPairValue,ye.toPairValue]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(be,{action:t,setAction:n,refresh:function(){Ze(),lt()},isLoading:it}),(0,v.jsxs)("div",{className:"px-4 py-5",children:[(0,v.jsxs)("div",{className:"text-white text-xs font-[500] flex flex-row justify-between",children:[(0,v.jsx)("p",{children:(0,v.jsx)(R.cC,{id:"Pay:"})}),(0,v.jsxs)("div",{onClick:Ee,className:"flex flex-row items-center space-x-2 text-white/25 fill-current cursor-pointer",children:[(0,v.jsx)(q.Z,{width:10,height:10}),(0,v.jsx)(D.Z,{mintAddress:Pe.address,decimals:Pe.decimals})]})]}),(0,v.jsx)("div",{className:(0,V.cn)("bg-[#19232D] rounded-xl relative","mt-1 p-2","lg:mt-3 lg:py-2 lg:px-3"),children:(0,v.jsx)(J.Z,{control:ae,pair:Pe,pairName:"fromPairValue",onSubmit:He,mintsList:ze,modalId:"PERPS_LP_PAIRS_SELECT_FROM_PAIR_MODAL_ID"})}),et||Ke?(0,v.jsxs)("div",{className:'relative mt-2 w-full rounded-lg border border-jupiter-yellow text-jupiter-yellow bg-jupiter-yellow bg-opacity-10 text-xs px-4 py-3 gap-2 flex flex-col items-center"',children:[et?(0,v.jsx)("p",{className:"text-xs ",children:et}):null,Ke?(0,v.jsx)("div",{className:"text-xs",children:Be?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("p",{children:o.ag._("The pool has reached its AUM limit, new funds are not accepted at the moment.")}),(0,v.jsx)("button",{type:"button",className:"underline mt-1",onClick:function(){return n("viaSwap")},children:o.ag._("Go to trade tab and learn more.")})]}):null}):null]}):null,(0,v.jsx)(je,{}),[].concat((0,a.Z)(at),[Re],(0,a.Z)(ot)).filter(Boolean).length>0&&(0,v.jsx)("div",{className:"bg-jupiter-red text-white px-3 py-2 rounded-lg text-xs mt-2",children:[].concat((0,a.Z)(at),[Re],(0,a.Z)(ot)).filter(Boolean).map((function(e){return(0,v.jsxs)("span",{className:"flex space-x-2 items-center",children:[(0,v.jsx)("div",{className:"w-3 h-3",children:(0,v.jsx)(z.Z,{})}),(0,v.jsx)("span",{children:e})]},e)}))}),null!==w&&void 0!==w&&w.adapter.publicKey?(0,v.jsx)("button",{type:"button",className:(0,V.cn)("font-semibold w-full mt-3 bg-jupiter-navy text-white rounded-lg items-center p-px shadow-lg",{"opacity-50 cursor-not-allowed":qe}),disabled:qe,onClick:oe(We),children:(0,v.jsx)("div",{className:"flex items-center justify-center px-8 py-4 rounded-lg dark:bg-black",children:(0,v.jsx)("span",{className:"text-center",children:Ge})})}):(0,v.jsx)(de.uS,{buttonClassName:"w-full !bg-transparent",overrideContent:(0,v.jsx)(T.Z,{className:"w-full mt-3",size:"md",children:(0,v.jsx)("span",{children:(0,v.jsx)(R.cC,{id:"Connect Wallet"})})})}),ye.fromPairValue&&ye.toPairValue&&null!==S&&void 0!==S&&S.lpTokenInfo?(0,v.jsx)("div",{className:"border border-v2-lily/10 mt-4 rounded-lg bg-v2-lily/5 p-3",children:(0,v.jsxs)("div",{className:"space-y-2 text-xs",children:[Ae&&Te&&Ie?(0,v.jsx)("div",{className:"inline",children:(0,v.jsx)(R.cC,{id:"{0} {1} <0>will be swapped to</0> {2} {3}<1> (lowest fee) and buy into the pool at</1><2>{feesText}</2><3>fees.</3>",values:{0:u.uf.format(ye.fromPairValue),1:Pe.symbol,2:u.uf.format(new p.Z(Ie.toString()).div(Math.pow(10,Te.decimals)).toDP(Te.decimals).toString()),3:Te.symbol,feesText:ct},components:{0:(0,v.jsx)("span",{className:"text-white/50"}),1:(0,v.jsx)("span",{className:"text-white/50"}),2:(0,v.jsx)("span",{className:"mx-1"}),3:(0,v.jsx)("span",{className:"text-white/50"})}})}):(0,v.jsx)("div",{children:(0,v.jsx)(R.cC,{id:"{0} {1} <0>will be bought into the pool at</0><1>{feesText}</1><2>fees.</2>",values:{0:u.uf.format(ye.fromPairValue),1:Pe.symbol,feesText:ct},components:{0:(0,v.jsx)("span",{className:"text-white/50"}),1:(0,v.jsx)("span",{className:"mx-1"}),2:(0,v.jsx)("span",{className:"text-white/50"})}})}),(0,v.jsx)("div",{children:(0,v.jsx)(R.cC,{id:"<0>You'll receive </0>{0} {PERPS_LP_TICKER}",values:{0:u.uf.format(ye.toPairValue),PERPS_LP_TICKER:b.t},components:{0:(0,v.jsx)("span",{className:"text-white/50"})}})}),(0,v.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,v.jsx)(fe.Z,{value:(0,u.Hd)(ye.fromPairValue)?Number(ye.fromPairValue):void 0,isSubmitting:ge.isSubmitting,lastRefreshTimestamp:rt,refresh:function(){Ze(),lt()}}),(0,v.jsx)(H.Z,{inputAmount:(0,u.Hd)(ye.fromPairValue)?W().BigInt(new p.Z(ye.fromPairValue).mul(Math.pow(10,Pe.decimals)).round().toFixed()):W().BigInt(0),outputAmount:W().BigInt(new p.Z(ye.toPairValue).mul(Math.pow(10,ke.decimals)).round().toFixed()),inputPair:Pe,outputPair:S.lpTokenInfo,reversible:!0})]})]})}):null]})]})},ke=n(795).Buffer,_e=function(e){var t=e.amount,n=e.toPairTokenInfo,s=(0,le.gs)().prioritizationFeeLamports,a=(0,l.Bn)(),m=a.connection,x=a.getTokenInfo,h=(0,f.tc)(),v=h.perpsTokens,g=h.oraclePrices,b=h.slippage,w=h.poolInfo,y=h.viewClient,j=h.custodies,P=(0,r.useState)(W().BigInt(0)),k=P[0],_=P[1],N=(0,r.useState)(W().BigInt(0)),S=N[0],T=N[1],I=(0,r.useMemo)((function(){var e=Object.values(v).flat();return!Boolean(e.find((function(e){return e.address===n.address})))}),[n.address,v]),R=(0,r.useMemo)((function(){if(w&&g)return j.map((function(e){var t=e.account,n=t.mint,r=t.assets,s=t.decimals,i=t.targetRatioBps,a=g&&g[n.toString()];if(!a)return null;var o=new p.Z(a.sellLp).mul(r.owned.toString()).div(Math.pow(10,s)).toDP(2),l=o.gt(0)?o.div(w.poolAumUsd).mul(100).toNearest(.01,p.Z.ROUND_DOWN).toNumber():0,c=function(){var e=r.owned.sub(r.locked),t=new p.Z(new p.Z(e.toString()).div(Math.pow(10,s))).mul(new p.Z(a.sellLp).mul(1e6));return new(C())(t.round().toString())}();return{mint:n.toString(),weightage:new p.Z(i.toString()).sub(100*l),availableLiquidity:c}})).filter(Boolean)}),[j,g,w]),Z=(0,r.useMemo)((function(){return n.decimals?new(C())(new p.Z(k.toString()).mul(100-b).div(100).toDP(0).toFixed()):new(C())(0)}),[n.decimals,k,b]),L=(0,r.useState)(!0),E=L[0],O=L[1],V=(0,r.useState)([]),B=V[0],K=V[1],D=(0,r.useState)(null),F=D[0],q=D[1],U=(0,r.useState)(null),H=U[0],G=U[1],$=Math.ceil(100*Number(b)),z=(0,oe.OO)({amount:k,inputMint:I&&F?new d.PublicKey(F.address):void 0,outputMint:I&&n?new d.PublicKey(n.address):void 0,slippageBps:$,maxAccounts:45}),Y=z.quoteResponseMeta,J=z.loading,X=z.error,Q=(0,r.useState)((new Date).getTime()),ee=Q[0],re=Q[1],se=(0,r.useCallback)((function(){if(!t||!y||!w||!R||!(0,u.Hd)(t)||!new p.Z(t).greaterThan(0))return _(W().BigInt(0)),void G(null);O(!0);var e=new(C())(new p.Z(t).mul(w.lpPriceInUSD).mul(1e6).round().toString()),r=R.filter((function(t){return t.availableLiquidity.gt(e)}));if(0===r.length)return K([o.ag._("Insufficient liquidity. Please try again with a smaller amount.")]),void O(!1);var s=r.sort((function(e,t){return e.weightage.toNumber()-t.weightage.toNumber()})),i=x(s[0].mint);if(i){q(i);var a=I?j.find((function(e){return e.account.mint.toBase58()===i.address})):j.find((function(e){return e.account.mint.toBase58()===n.address}));a&&y.getRemoveLiquidityAmountAndFee(new(C())(new p.Z(t).mul(Math.pow(10,w.lpTokenInfo.decimals)).toDP(0).toFixed()),a).then((function(e){e?(_(W().BigInt(e.amount)),G(e.feeBps),K([])):(_(W().BigInt(0)),G(new(C())(0)),K([o.ag._("Failed to simulate the trade. Please try again.")]))})).finally((function(){O(!1),re((new Date).getTime())}))}}),[t,R,j,x,I,w,n.address,y]);(0,r.useEffect)((function(){se()}),[t,n.address,$]),(0,r.useEffect)((function(){var e;return T(null!==(e=null===Y||void 0===Y?void 0:Y.quoteResponse.outAmount)&&void 0!==e?e:W().BigInt(0))}),[Y]);var ie=(0,c.FB)((null===F||void 0===F?void 0:F.address)||d.PublicKey.default).balanceLamports,ae=(0,r.useCallback)(function(){var e=(0,A.Z)(M().mark((function e(t){var r,a,o,l,c,u,p,f,x,h,v,g,b,y,j,P;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userPublicKey,e.prev=1,Y&&F&&null!==w&&void 0!==w&&w.lpMint){e.next=4;break}throw new Error("Invalid quote response");case 4:return e.next=6,(0,ne.c1)(new d.PublicKey(F.address),r,m);case 6:return o=e.sent,l=(0,i.Z)(o,1),c=l[0],e.next=11,(0,ne.c1)(new d.PublicKey(n.address),r,m);case 11:return u=e.sent,p=(0,i.Z)(u,1),f=p[0],x={quoteResponse:null===Y||void 0===Y?void 0:Y.original,userPublicKey:r.toBase58(),wrapAndUnwrapSol:Boolean(!1),prioritizationFeeLamports:s,sourceTokenAccount:c,destinationTokenAccount:f,useTokenLedger:!0},e.next=17,fetch("https://quote-api.jup.ag/v6/swap-instructions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});case 17:return e.next=19,e.sent.json().catch(function(){var e=(0,A.Z)(M().mark((function e(t){var n,r,s;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,r=n.error,s=n.message,e.abrupt("return",{error:new ne.qw(s,void 0,r)});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:if(!("error"in(a=e.sent))){e.next=22;break}throw new Error(a.error.message);case 22:return v=(h=a).tokenLedgerInstruction,g=h.swapInstruction,b=h.addressLookupTableAddresses,y=new d.TransactionInstruction({programId:new d.PublicKey(v.programId),keys:v.accounts.map((function(e){return{pubkey:new d.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ke.from(v.data,"base64")}),j=new d.TransactionInstruction({programId:new d.PublicKey(g.programId),keys:g.accounts.map((function(e){return{pubkey:new d.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ke.from(g.data,"base64")}),e.next=27,te(m,b);case 27:return P=e.sent,e.abrupt("return",{tokenLedgerInstruction:y,swapInstruction:j,addressLookupTableAccounts:P});case 31:throw e.prev=31,e.t0=e.catch(1),e.t0;case 34:case"end":return e.stop()}}),e,null,[[1,31]])})));return function(t){return e.apply(this,arguments)}}(),[F,s,m,null===w||void 0===w?void 0:w.lpMint,Y,n.address]),ce=(0,r.useMemo)((function(){return I?E||J:E}),[I,E,J]);(0,r.useEffect)((function(){Y&&O(!1)}),[Y]);var ue=(0,r.useMemo)((function(){var e;if(R&&0!==(null===R||void 0===R?void 0:R.length)){var t=I?null===F||void 0===F?void 0:F.address:null===n||void 0===n?void 0:n.address,r=Object.values(R).find((function(e){return e.mint===t}));return null!==(e=null===r||void 0===r?void 0:r.availableLiquidity.muln(995).divn(1e3))&&void 0!==e?e:null}}),[R,null===F||void 0===F?void 0:F.address,I,null===n||void 0===n?void 0:n.address]),de=(0,r.useMemo)((function(){if(I&&X)return o.ag._("We're having trouble finding route for this trade. Please try again with different amount or other token.")}),[X,I]);return{isLoading:ce,quoteResponseMeta:Y,basketTokenWithLowestFee:F,isTokenSwapRequired:I,feeBps:H,receiveAmount:I?S:k,minReceiveAmount:Z,getSwapIx:ae,tokenSwapOriginalBalance:ie,sellTokenAvailableLiquidity:ue,error:B,hasJupiterError:de,lastRefreshTimestamp:ee,refresh:se}};function Ne(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Se(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw i}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=E()((function(){return n.e(4642).then(n.bind(n,64642))}),{ssr:!1,loadableGenerated:{webpack:function(){return[64642]}}}),Ae=function(e){var t=e.action,n=e.setAction,s=(0,l.Bn)(),m=s.connection,h=s.getTokenInfo,g=s.tokens,w=(0,l.Os)(),y=w.wallet,j=w.signTransaction,P=(0,f.tc)(),k=P.viewClient,_=P.refreshViews,N=P.poolInfo,S=P.oraclePrices,I=P.perpsTokens,Z=P.custodies,L=(0,me.R3)(),E=(0,pe.KO)(xe.yz),U=(0,i.Z)(E,1)[0],X=(0,le.gs)().priorityLevel,Q=(0,l.C9)(),ee=(0,O.cI)({defaultValues:{fromPair:Y.Lr.toString(),fromPairValue:"",toPair:"",receiveAmount:"",minReceiveAmount:""}}),te=ee.control,ne=ee.handleSubmit,re=ee.watch,se=ee.setValue,ae=ee.formState,oe=re(),ce=(0,r.useMemo)((function(){return(null===N||void 0===N?void 0:N.lpTokenInfo)||Y.Zt}),[N]);(0,r.useEffect)((function(){var e;null!==N&&void 0!==N&&N.lpTokenInfo&&se("fromPair",null===N||void 0===N||null===(e=N.lpTokenInfo)||void 0===e?void 0:e.address.toString())}),[null===N||void 0===N?void 0:N.lpTokenInfo,se]);var ue=(0,r.useMemo)((function(){return h(oe.toPair)||Y.Zt}),[h,oe.toPair]);(0,r.useEffect)((function(){se("toPair",ue.address)}),[ue,se]);var ve=_e({amount:(0,u.Hd)(oe.fromPairValue)?oe.fromPairValue:"",toPairTokenInfo:ue}),ge=ve.isLoading,we=ve.quoteResponseMeta,ye=ve.feeBps,je=ve.minReceiveAmount,Pe=ve.receiveAmount,ke=ve.basketTokenWithLowestFee,Se=ve.isTokenSwapRequired,Ae=ve.getSwapIx,Ie=ve.sellTokenAvailableLiquidity,Me=ve.hasJupiterError,Re=ve.error,Ze=ve.lastRefreshTimestamp,Ce=ve.refresh,Le=(0,r.useCallback)((function(e){se("fromPair",e.address.toString()),se("fromPairValue","")}),[se]),Ee=(0,r.useCallback)((function(e){se("toPair",e.address.toString()),se("fromPairValue","")}),[se]),Oe=(0,c.FB)(oe.fromPair,ce.decimals),Ve=Oe.balance,Be=Oe.balanceLamports,Ke=(0,r.useCallback)((function(e){e.preventDefault(),se("fromPairValue",String(Ve))}),[Ve,se]),De=Number(oe.fromPairValue)>Ve,Fe=(0,l.iG)(),qe=(0,r.useMemo)((function(){var e,t=null===(e=Fe.account)||void 0===e?void 0:e.account.lamports;return!t||t<F.WO}),[Fe.account]),Ue=(0,r.useMemo)((function(){if(!S)return null;var e=S[ue.address];return e?e.sellLp:null}),[S,ue.address]),We=(0,r.useMemo)((function(){return!!(Ie&&je&&Ue)&&new p.Z(je.toString()).div(Math.pow(10,ue.decimals)).mul(Ue).mul(1e6).gt(Ie.toString())}),[je,Ie,ue.decimals,Ue]);(0,r.useEffect)((function(){var e=[];We&&(e.push(o.ag._("There is not enough liquidity due to utilization rate of your selected token, please try a different token.")),e.push(o.ag._("Available liquidity: ${0}",{0:new p.Z(Ie?Ie.toString():0).div(1e6).toFixed(2)}))),Xe(e.join("\n"))}),[We,Ie]),(0,r.useEffect)((function(){if(!je||!oe.fromPairValue||je.isZero())return se("receiveAmount",""),void se("minReceiveAmount","");se("receiveAmount",new p.Z(Pe.toString()).div(Math.pow(10,ue.decimals)).toFixed()),se("minReceiveAmount",new p.Z(je.toString()).div(Math.pow(10,ue.decimals)).toFixed())}),[je,Pe,se,ue.decimals,oe.fromPairValue]);var He=(0,r.useMemo)((function(){return qe||De||ae.isSubmitting||!je||We||Boolean(Me)||Re.length>0}),[qe,De,ae.isSubmitting,je,We,Me,Re]);(0,$.Gl)(ge||!Se||null===we||void 0===we?void 0:we.quoteResponse,(null===ke||void 0===ke?void 0:ke.address)||"",(null===ue||void 0===ue?void 0:ue.address)||"");var Ge=(0,G.Z)({selectedRoute:we,hasEnoughSOL:!qe}).errors,$e=r.useCallback(function(){var e=(0,A.Z)(M().mark((function e(t){var n,r,s,i,a,l,c,u,x;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fromPairValue,!He&&k&&null!==y&&void 0!==y&&y.adapter.publicKey&&n&&N&&j){e.next=3;break}return e.abrupt("return");case 3:if(r=ke?Se?Z.find((function(e){return e.account.mint.toBase58()===ke.address})):Z.find((function(e){return e.account.mint.toBase58()===ue.address})):null){e.next=6;break}return e.abrupt("return");case 6:return"",e.prev=7,s=new(C())(new p.Z(n).mul(Math.pow(10,ce.decimals)).toDP(0).toFixed()),e.next=11,m.getLatestBlockhash("confirmed");case 11:return i=e.sent,a=i.blockhash,l=i.lastValidBlockHeight,c={lpTokenMint:new d.PublicKey(N.lpMint),wallet:y,publicKey:y.adapter.publicKey,connection:m,custody:r,payAmount:s,minReceiveAmount:je,custodyMetas:k.getCustodyMetas(),shouldCloseLpTokenAccount:s.eq(Be),getSwapIx:null,blockhash:a},Se&&(c.minReceiveAmount=new(C())(0),c.getSwapIx=Ae),e.next=18,ie(c);case 18:return u=e.sent,e.next=21,L(u,{blockhash:a,lastValidBlockHeight:l,idl:he.x,idlProgramId:f.KX,skipPreflight:!0},{submittingMessage:o.ag._("Removing {fromPairValue} {PERPS_LP_TICKER} for {0} {1} from liquidity pool",{0:new p.Z(je.toString()).div(Math.pow(10,ue.decimals)).toString(),1:ue.symbol,fromPairValue:n,PERPS_LP_TICKER:b.t}),successMessage:o.ag._("Successfully removed {fromPairValue} {0} from pool",{0:ce.symbol,fromPairValue:n}),errorMessage:o.ag._("Failed to sell {PERPS_LP_TICKER} from pool!",{PERPS_LP_TICKER:b.t}),referenceFee:U.isOutdated?null:"MEDIUM"===X?U.claim:"HIGH"===X&&U.claim?1.5*U.claim:"VERY_HIGH"===X&&U.claim?3*U.claim:void 0,minimumFee:xe.uo,requestComputeBudgetLimit:15e4});case 21:if(!("error"in(x=e.sent))){e.next=24;break}throw x.error;case 24:se("fromPairValue",""),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(7),console.error("Failed to sell into LP pool",e.t0);case 30:return e.prev=30,Q(),_(),e.finish(30);case 34:case"end":return e.stop()}}),e,null,[[7,27,30,34]])})));return function(t){return e.apply(this,arguments)}}(),[He,k,y,N,j,ke,Se,Z,ue.address,ue.decimals,ue.symbol,ce.decimals,ce.symbol,m,je,Be,L,se,Ae,U.isOutdated,U.claim,X,Q,_]),ze=r.useMemo((function(){if(oe.fromPairValue){if(De||qe)return o.ag._("Insufficient {0}",{0:qe?"SOL":ce.symbol});if(ae.isSubmitting)return(0,v.jsxs)("span",{className:"flex justify-center items-center",children:[(0,v.jsx)(K.Z,{className:"!h-4 !w-4",baseColor:"white",spinnerColor:"black"}),(0,v.jsx)("div",{className:"mr-2"}),o.ag._("Selling {PERPS_LP_TICKER}",{PERPS_LP_TICKER:b.t})]})}return(0,v.jsx)(B.Z,{children:(0,v.jsx)(R.cC,{id:"Sell"})})}),[ae.isSubmitting,ce,De,qe,oe.fromPairValue]),Ye=(0,r.useState)(""),Je=Ye[0],Xe=Ye[1],Qe=(0,r.useMemo)((function(){return ye&&oe.fromPairValue&&je?"".concat(new p.Z(ye.toString()).div(100).toString(),"%"):""}),[ye,je,oe.fromPairValue]),et=(0,r.useMemo)((function(){var e;return Boolean(null===y||void 0===y||null===(e=y.adapter.supportedTransactionVersions)||void 0===e?void 0:e.has(0))}),[null===y||void 0===y?void 0:y.adapter.supportedTransactionVersions]),tt=(0,r.useMemo)((function(){if(null!==y&&void 0!==y&&y.adapter.connected&&!et)return[].concat((0,a.Z)(I.nonStableTokens),(0,a.Z)(I.stableTokens)).map((function(e){return e.address}));var e,t=[],n=Ne(g);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.address!==(null===N||void 0===N?void 0:N.lpTokenInfo.address)&&t.push(r.address)}}catch(s){n.e(s)}finally{n.f()}return t}),[I.nonStableTokens,I.stableTokens,null===N||void 0===N?void 0:N.lpTokenInfo.address,g,et,null===y||void 0===y?void 0:y.adapter.connected]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(be,{action:t,setAction:n,refresh:Ce,isLoading:ge}),(0,v.jsxs)("div",{className:"px-4 py-5",children:[(0,v.jsxs)("div",{className:"text-white text-xs font-[500] flex flex-row justify-between",children:[(0,v.jsx)("p",{children:(0,v.jsx)(R.cC,{id:"Pay:"})}),(0,v.jsxs)("div",{onClick:Ke,className:"flex flex-row items-center space-x-2 text-white/25 fill-current cursor-pointer",children:[(0,v.jsx)(q.Z,{width:10,height:10}),(0,v.jsx)(D.Z,{mintAddress:ce.address,decimals:ce.decimals})]})]}),(0,v.jsx)("div",{className:(0,V.cn)("bg-[#19232D] rounded-xl relative","mt-1 p-2 py-3","lg:mt-3 lg:p-4"),children:(0,v.jsx)(J.Z,{control:te,pair:ce,pairName:"fromPairValue",onSubmit:Le,hideUSDValue:!0,disableTokenSelect:!0,mintsList:[],modalId:"PERPS_LP_PAIRS_SELECT_FROM_PAIR_MODAL_ID"})}),(0,v.jsxs)("div",{className:"mt-8 text-white text-xs font-[500] flex flex-row justify-between",children:[(0,v.jsx)("p",{children:(0,v.jsx)(R.cC,{id:"Sell into"})}),(0,v.jsxs)("div",{className:"flex flex-row items-center space-x-2 text-white/25 fill-current",children:[(0,v.jsx)(q.Z,{width:10,height:10}),(0,v.jsx)(D.Z,{mintAddress:ue.address,decimals:ue.decimals})]})]}),(0,v.jsxs)("div",{className:(0,V.cn)("bg-[#19232D] rounded-xl relative","mt-1 p-2","lg:mt-3 lg:py-2 lg:px-3"),children:[(0,v.jsx)(J.Z,{disabled:!0,control:te,pair:ue,pairName:"receiveAmount",onSubmit:Ee,mintsList:tt,modalId:"PERPS_LP_PAIRS_SELECT_TO_PAIR_MODAL_ID"}),(0,u.Hd)(oe.fromPairValue)&&ge?(0,v.jsx)(x.O,{className:"absolute top-2 right-2 !w-[calc(100%-140px)] !h-10"}):null]}),Je?(0,v.jsx)("div",{className:'relative mt-2 w-full rounded-lg border border-jupiter-yellow text-jupiter-yellow bg-jupiter-yellow bg-opacity-10 text-xs px-4 py-3 space-x-2 flex flex-row items-center"',children:(0,v.jsx)("div",{className:"text-xs whitespace-pre-line",children:Je})}):null,(0,v.jsx)(Te,{}),[].concat((0,a.Z)(Ge),[Me],(0,a.Z)(Re)).filter(Boolean).length>0&&(0,v.jsx)("div",{className:"bg-jupiter-red text-white px-3 py-2 rounded-lg text-xs mt-2",children:[].concat((0,a.Z)(Ge),[Me],(0,a.Z)(Re)).filter(Boolean).map((function(e){return(0,v.jsxs)("span",{className:"flex space-x-2 items-center",children:[(0,v.jsx)("div",{className:"w-3 h-3",children:(0,v.jsx)(z.Z,{})}),(0,v.jsx)("span",{children:e})]},e)}))}),null!==y&&void 0!==y&&y.adapter.publicKey?(0,v.jsx)("button",{type:"button",className:(0,V.cn)("font-semibold w-full mt-3 bg-jupiter-navy text-white rounded-lg items-center p-px shadow-lg",{"opacity-50 cursor-not-allowed":He}),disabled:He,onClick:ne($e),children:(0,v.jsx)("div",{className:"flex items-center justify-center px-8 py-4 rounded-lg dark:bg-black",children:(0,v.jsx)("span",{className:"text-center",children:ze})})}):(0,v.jsx)(de.uS,{buttonClassName:"w-full !bg-transparent",overrideContent:(0,v.jsx)(T.Z,{className:"w-full mt-3",size:"md",children:(0,v.jsx)("span",{children:(0,v.jsx)(R.cC,{id:"Connect Wallet"})})})}),oe.fromPairValue&&Pe&&null!==N&&void 0!==N&&N.lpTokenInfo?(0,v.jsx)("div",{className:"border border-v2-lily/10 mt-4 rounded-lg bg-v2-lily/5 p-3",children:(0,v.jsxs)("div",{className:"space-y-2 text-xs",children:[Se&&ke?(0,v.jsx)("div",{className:"inline",children:(0,v.jsx)(R.cC,{id:"<0>You're selling </0>{0} {1} <1>from the pool at </1><2>{feesText}</2><3>fees, and it will be swapped from</3> {2}<4> (lowest fee) </4><5>to</5> {3} {4}.",values:{0:u.uf.format(oe.fromPairValue),1:ce.symbol,2:ke.symbol,3:u.uf.format(new p.Z(Pe.toString()).div(Math.pow(10,ue.decimals)).toDP(ue.decimals).toString()),4:ue.symbol,feesText:Qe},components:{0:(0,v.jsx)("span",{className:"text-white/50"}),1:(0,v.jsx)("span",{className:"text-white/50"}),2:(0,v.jsx)("span",{className:"mx-1"}),3:(0,v.jsx)("span",{className:"text-white/50"}),4:(0,v.jsx)("span",{className:"text-white/50"}),5:(0,v.jsx)("span",{className:"text-white/50"})}})}):(0,v.jsx)("div",{children:(0,v.jsx)(R.cC,{id:"{0} {1} <0>will be sold from the pool at</0><1>{feesText}</1><2>fees.</2>",values:{0:oe.fromPairValue,1:ce.symbol,feesText:Qe},components:{0:(0,v.jsx)("span",{className:"text-white/50"}),1:(0,v.jsx)("span",{className:"mx-1"}),2:(0,v.jsx)("span",{className:"text-white/50"})}})}),(0,v.jsx)("div",{children:(0,v.jsx)(R.cC,{id:"<0>You'll receive </0>{0} {1}",values:{0:new p.Z(Pe.toString()).div(Math.pow(10,ue.decimals)).toString(),1:ue.symbol},components:{0:(0,v.jsx)("span",{className:"text-white/50"})}})}),(0,v.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,v.jsx)(fe.Z,{value:(0,u.Hd)(oe.fromPairValue)?Number(oe.fromPairValue):void 0,isSubmitting:ae.isSubmitting,lastRefreshTimestamp:Ze,refresh:Ce}),(0,v.jsx)(H.Z,{inputAmount:(0,u.Hd)(oe.fromPairValue)?W().BigInt(new p.Z(oe.fromPairValue).mul(Math.pow(10,ce.decimals)).round().toFixed()):W().BigInt(0),outputAmount:W().BigInt(new p.Z(Pe.toString()).round().toFixed()),inputPair:ce,outputPair:ue,reversible:!0})]})]})}):null]})]})},Ie=function(){var e,t=(0,l.Os)().publicKey,n=(0,f.tc)(),s=n.custodies,m=n.poolInfo,_=n.oraclePrices,A=n.perpsTokens,I=(0,l.gZ)().fetchTokenAccounts,M=(0,c.FB)(null!==(e=null===m||void 0===m?void 0:m.lpTokenInfo.address)&&void 0!==e?e:d.PublicKey.default,null===m||void 0===m?void 0:m.lpTokenInfo.decimals);(0,r.useEffect)((function(){null!==m&&void 0!==m&&m.lpMint&&I([null===m||void 0===m?void 0:m.lpMint])}),[m,I]);var R=(0,r.useMemo)((function(){return _&&s?s.reduce((function(e,t){var n,r,s=t.account.assets.owned,i=null!==(n=null===(r=_[t.account.mint.toString()])||void 0===r?void 0:r.buyLp)&&void 0!==n?n:new p.Z(0),a=new p.Z(i).mul(s.toString()).div(Math.pow(10,t.account.decimals)).toDP(2);return e.add(a)}),new p.Z(0)):new p.Z(0)}),[s,_]),Z=(0,r.useMemo)((function(){return null!==m&&void 0!==m&&m.poolApr.lastUpdated?new Date(null===m||void 0===m?void 0:m.poolApr.lastUpdated.muln(1e3).toNumber()).toLocaleDateString():null}),[null===m||void 0===m?void 0:m.poolApr.lastUpdated]),C=(0,P.Z)(),L=C.availableAUMQuotas,E=C.totalAUMQuotas,O=(0,r.useMemo)((function(){return[].concat((0,a.Z)(A.nonStableTokens),(0,a.Z)(A.stableTokens))}),[A]),V=r.useState("APY"),B=(0,i.Z)(V,2),K=B[0],D=B[1],F=(0,r.useCallback)((function(){D((function(e){return"APR"===e?"APY":"APR"}))}),[]),q=(0,r.useMemo)((function(){if(null===m||void 0===m||!m.poolApr.feeAprBps)return"";var e=new p.Z(m.poolApr.feeAprBps.toString()).div(100),t="APR"===K?e:(0,h.b)(e);return"".concat(t.toFixed(2),"%")}),[K,null===m||void 0===m?void 0:m.poolApr.feeAprBps]),U=(0,r.useMemo)((function(){return"JLP Earn ".concat(q)}),[q]),W=(0,r.useState)("viaSwap"),H=W[0],G=W[1];return(0,v.jsxs)("div",{className:"w-full lg:flex justify-center px-4",children:[(0,v.jsx)(j.PB,{title:U}),(0,v.jsxs)("div",{className:"block w-full lg:px-4 pb-4 max-w-7xl gap-2 lg:gap-6 lg:flex",children:[(0,v.jsxs)("div",{className:"w-full overflow-x-scroll hideScrollbar",children:[(0,v.jsxs)("div",{className:"rounded-lg border border-labs/10 p-4 lg:px-6 lg:py-4 bg-labs/5 lg:flex justify-between",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("span",{className:"text-[30px] font-semibold leading-none text-labs",children:(0,v.jsx)("h1",{children:o.ag._("{PERPS_LP_TICKER} Pool",{PERPS_LP_TICKER:b.t})})}),(0,v.jsx)("p",{className:"mt-1 text-xs text-labs/75",children:o.ag._("{PERPS_LP_TICKER} is the liquidity provider token. The APY, denominated in USD, is calculated based on fees generated from perps trading activities and doesn\u2019t include assets appreciation and traders PnL.",{PERPS_LP_TICKER:b.t})}),(0,v.jsx)("p",{className:"mt-1 text-xs text-labs/75",children:o.ag._("70% of generated fees are distributed back to holders by redepositing the fees into the pool hourly and thus increasing the JLP price.")}),(0,v.jsxs)(N(),{href:"https://station.jup.ag/labs/perpetual-exchange/jlp-pool",target:"_blank",className:"mt-1 text-xs flex space-x-1 items-center text-labs/75 fill-current",children:[(0,v.jsx)("p",{className:"text-xs",children:o.ag._("Learn more")}),(0,v.jsx)(S.Z,{})]})]}),(0,v.jsxs)("div",{className:"mt-8 lg:mt-0 lg:text-end min-w-[120px]",children:[(0,v.jsxs)("div",{className:"text-sm text-labs/75 font-semibold flex lg:justify-end items-center space-x-1",children:[(0,v.jsx)("span",{children:"APY"===K?o.ag._("APY"):o.ag._("APR")}),(0,v.jsx)(y.Z,{content:(0,v.jsxs)("div",{className:"flex flex-col !text-left space-y-2",children:[(0,v.jsx)("p",{children:o.ag._("APR/APY is updated weekly based on the fees generated by the pool denominated in USD.")}),(0,v.jsx)("p",{children:o.ag._("Fees are compounded automatically every hour.")})]}),children:(0,v.jsx)(w.Z,{width:16,height:16})})]}),q?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(y.Z,{content:o.ag._("Click to toggle between APR / APY"),children:(0,v.jsx)("p",{onClick:F,className:"cursor-pointer mt-2 text-xl font-semibold text-labs leading-none",children:q})})}):(0,v.jsx)(x.O,{className:"!h-7 !w-20"}),(0,v.jsx)("p",{className:"mt-1 text-xs text-v2-lily/30",children:o.ag._("Last updated at {lastUpdatedAtText}",{lastUpdatedAtText:Z})})]})]}),(0,v.jsxs)("div",{className:"mt-3 w-full py-6 bg-white/[0.03] rounded-xl overflow-hidden relative border border-white/5",children:[(0,v.jsx)("p",{className:"px-5 text-white/50 text-sm",children:o.ag._("Total Value Locked")}),(0,v.jsx)("div",{className:"px-5 mt-3 mb-6",children:m?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("p",{className:"text-3xl font-semibold",children:["$",u.uf.format(m.poolAumUsd.toDP(2).toNumber())]}),(0,v.jsxs)("div",{className:"flex space-x-1 text-xs text-v2-lily/50 mt-1",children:[(0,v.jsx)("span",{className:"",children:o.ag._("AUM limit:")}),(0,v.jsxs)("span",{children:["$",u.uf.format(E.toDP(2).toNumber())]}),(0,v.jsx)(y.Z,{content:(0,v.jsxs)("div",{className:"flex flex-col !text-left space-y-1",children:[(0,v.jsx)("p",{children:o.ag._("The pool is only accepting new funds up to ${0} at the moment.",{0:u.uf.format(E.toDP(2).toNumber())})}),(0,v.jsx)("p",{className:"text-v2-lily/50",children:o.ag._("Remaining quotas: ${0}",{0:u.uf.format(p.Z.max(L,0).toDP(2).toNumber())})})]}),children:(0,v.jsx)(w.Z,{width:16,height:16})})]})]}):(0,v.jsx)(x.O,{className:"!h-9 !w-40"})}),(0,v.jsx)("div",{className:"border-t border-white/5",children:(0,v.jsx)("p",{className:"p-4 text-sm text-white/50",children:o.ag._("Liquidity Allocation")})}),(0,v.jsx)("div",{className:"overflow-x-auto hideScrollbar",children:(0,v.jsxs)(k,{background:"rgba(35,48,60)",shadow:"rgba(255,255,255,0.2)",children:[(0,v.jsxs)("div",{className:"flex flex-row items-center justify-between px-6",children:[(0,v.jsx)("div",{className:"w-full min-w-[150px]",children:(0,v.jsx)("span",{className:"text-white/25 text-xs",children:o.ag._("Token")})}),(0,v.jsx)("div",{className:"w-full min-w-[222px] flex justify-center",children:(0,v.jsx)("span",{className:"text-white/25 text-xs",children:o.ag._("Pool Size")})}),(0,v.jsx)("div",{className:"w-full min-w-[186px]",children:(0,v.jsxs)("span",{className:"text-white/25 text-xs flex justify-center items-center space-x-1 text-center",children:[(0,v.jsx)("span",{children:o.ag._("Current / Target Weightage")}),(0,v.jsx)(y.Z,{content:o.ag._("Liquidity providers are encouraged to rebalance the pool to their target weightage, fees are determined based on current weightage."),children:(0,v.jsx)(w.Z,{width:16,height:16})})]})}),(0,v.jsx)("div",{className:"w-full min-w-[82px] text-end",children:(0,v.jsx)("span",{className:"text-white/25 text-xs",children:o.ag._("Utilization")})})]}),(0,v.jsx)("div",{className:"flex flex-col justify-between w-full",children:s.length>0?s.map((function(e,t){return(0,v.jsx)("div",{className:"px-6 min-w-[688px] w-full",children:(0,v.jsx)("div",{className:"border-b-white/5 border-b",children:(0,v.jsx)(g,{custody:e,totalPoolValue:R})})},t)})):Array(4).fill(void 0).map((function(e,t){return(0,v.jsx)("div",{className:"px-6",children:(0,v.jsx)("div",{className:"border-b-white/5 border-b",children:(0,v.jsx)(x.O,{className:"!h-[64px]"},t)})},t)}))})]})}),(0,v.jsxs)("div",{className:"space-y-3 px-6 mt-6",children:[(0,v.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,v.jsx)("div",{className:"text-v2-lily fill-current text-xs flex items-center space-x-1",children:(0,v.jsx)("p",{className:"text-xs text-white/50",children:o.ag._("{PERPS_LP_TICKER} Price",{PERPS_LP_TICKER:b.t})})}),m?(0,v.jsxs)("span",{className:"text-xs",children:["$",m.lpPriceInUSD.toDP(3).toNumber()]}):(0,v.jsx)(x.O,{className:"!h-4 !w-20"})]}),(0,v.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,v.jsx)("p",{className:"text-xs text-white/50",children:o.ag._("Total Supply")}),m?(0,v.jsxs)("p",{className:"text-xs ",children:[u.uf.format(m.lpTokenSupply.toDP(3).toNumber())," ",b.t]}):(0,v.jsx)(x.O,{className:"!h-4 !w-20"})]})]})]})]}),(0,v.jsxs)("div",{className:"mt-4 lg:mt-0 w-full lg:w-[360px] lg:min-w-[360px] lg:max-w-[360px]",children:[(0,v.jsxs)("div",{className:"bg-[#304256] rounded-xl flex flex-col justify-between",children:[t?(0,v.jsxs)("div",{className:"py-6 px-5 border-b border-b-white/5",children:[(0,v.jsx)("span",{className:"text-sm text-white/50",children:o.ag._("Your LP")}),(0,v.jsx)("div",{children:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("p",{className:"text-2xl font-semibold",children:[u.uf.format(M.balance)," ",b.t]}),(0,v.jsxs)("p",{className:"text-xs text-white/50",children:["~ $",m?u.uf.format(new p.Z(M.balance).mul(m.lpPriceInUSD).toDP(3).toNumber()):0]})]})})]}):null,(0,v.jsx)("div",{className:"flex flex-col justify-center",children:"viaSwap"===H?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(be,{action:H,setAction:G,isLoading:!1}),(0,v.jsxs)("div",{className:"p-4 flex flex-col",children:[(0,v.jsx)("p",{className:"text-xs text-v2-lily/50",children:o.ag._("To provide liquidity into the {PERPS_LP_TICKER} Pool, you just have to buy the {PERPS_LP_TICKER} token from Jupiter Swap.",{PERPS_LP_TICKER:b.t})}),(0,v.jsx)("p",{className:"text-xs text-v2-lily/50 mt-2",children:o.ag._("{PERPS_LP_TICKER} Pool is directly integrated with Jupiter Swap, along with sophisticated routing, offering you the best price.",{PERPS_LP_TICKER:b.t})}),(0,v.jsx)(N(),{shallow:!0,href:"/swap/USDC-".concat(b.t),className:"mt-4",children:(0,v.jsx)(T.Z,{size:"sm",children:(0,v.jsx)("span",{className:"text-base",children:o.ag._("Buy / Sell {PERPS_LP_TICKER}",{PERPS_LP_TICKER:b.t})})})})]})]}):"buy"===H?(0,v.jsx)(Pe,{action:H,setAction:G}):(0,v.jsx)(Ae,{action:H,setAction:G})})]}),(0,v.jsx)("div",{className:"border border-v2-lily/10 mt-4 rounded-lg bg-v2-lily/5 p-3",children:(0,v.jsx)("div",{className:"space-y-2 text-xs",children:(0,v.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,v.jsx)("span",{className:"text-white/70",children:o.ag._("{PERPS_LP_TICKER} token value are:",{PERPS_LP_TICKER:b.t})}),(0,v.jsxs)("ul",{className:"text-v2-lily/50 list-disc list-outside w-full px-3 space-y-1.5",children:[(0,v.jsxs)("li",{className:"",children:[o.ag._("An index fund of")," ",(0,v.jsx)("span",{className:"text-v2-lily/75",children:O.map((function(e){return e.symbol})).join(", ")}),"."]}),(0,v.jsx)("li",{className:"list-outside",children:o.ag._("Trader's profit and loss")}),(0,v.jsx)("li",{className:"list-outside",children:o.ag._("70% of the generated fees")})]}),(0,v.jsxs)(N(),{href:"https://station.jup.ag/labs/perpetual-exchange/jlp-pool",target:"_blank",className:"mt-1 text-xs flex space-x-1 text-v2-lily/50 items-center fill-current",children:[(0,v.jsx)("p",{className:"text-xs",children:o.ag._("Learn more")}),(0,v.jsx)(S.Z,{})]})]})})}),(0,v.jsx)("div",{className:"pb-20"})]})]})]})},Me=!0,Re=function(){return(0,v.jsx)(s.Z,{children:(0,v.jsx)(Ie,{})})}},14167:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r=function(){return(1e5*Math.random()).toFixed(0)}},64808:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/perps-earn",function(){return n(80787)}])}},function(e){e.O(0,[4508,2420,3215,7821,5516,5010,1672,7179,9774,2888,179],(function(){return t=64808,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=perps-earn-cf89eb8989faf88e.js.map