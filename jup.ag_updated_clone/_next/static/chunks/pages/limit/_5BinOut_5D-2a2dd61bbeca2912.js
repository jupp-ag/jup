(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5285],{84914:function(e,t,r){"use strict";var n=r(93981),i=r(42754),a=r(81423),s=r(91511),o=r(17769),l=r(29541);r(11805);t.ZP=function(e){var t=e.children,r=(0,o.NL)(),c=(0,n.useState)((function(){return s.d.createClient({transformer:i.ZP,links:[(0,a.N8)({url:"".concat("","/api/trpc")})]})}))[0];return(0,l.jsx)(s.d.Provider,{client:c,queryClient:r,children:t})}},33986:function(e,t,r){"use strict";var n=r(29541);t.Z=function(e){var t=e.width,r=void 0===t?16:t,i=e.height,a=void 0===i?16:i;return(0,n.jsx)("svg",{width:r,height:a,viewBox:"0 0 16 16",fill:"inherit",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M10.8573 8.18429L13.6323 5.95933L10.8573 3.73438V5.31937H3.32735V6.59937H10.8573V8.18429ZM5.14223 7.81429L2.36719 10.0393L5.14223 12.2642V10.6792H12.6722V9.39922H5.14223V7.81429Z",fill:"inherit"})})}},55948:function(e,t,r){"use strict";var n=r(29541);t.Z=function(e){var t=e.className,r=void 0===t?"":t;return(0,n.jsx)("svg",{className:r,width:"10",height:"6",viewBox:"0 0 10 6",fill:"inherit",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.292893 0.292893C0.683416 -0.097631 1.31658 -0.097631 1.7071 0.292893L4.99999 3.58579L8.29288 0.292893C8.6834 -0.0976311 9.31657 -0.0976311 9.70709 0.292893C10.0976 0.683417 10.0976 1.31658 9.70709 1.70711L5.7071 5.70711C5.31657 6.09763 4.68341 6.09763 4.29289 5.70711L0.292893 1.70711C-0.0976309 1.31658 -0.0976309 0.683417 0.292893 0.292893Z",fill:"currentColor"})})}},29151:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return We},default:function(){return ze}});var n=r(93981),i=r(63790),a=r(70107),s=r(63956),o=r(97620),l=r(27195),c=r(8857),u=r.n(c),d=r(73360),m=r(7761),f=r(22060),x=r(83064),h=r(94728),p=r(65558),v=r.n(p),b=r(91551),g=r.n(b),k=r(13838),w=r(59603),j=r.n(w),y=r(64508),P=r.n(y),N=r(71048),C=r(84985),Z=r(17769),I=r(13170),M=r(63277),O=r(42082),T=r(22466),S=r(29541),F={decimals:6,address:"",chainId:101,name:"",symbol:""},B=(0,n.createContext)(null),V=function(){var e=(0,n.useContext)(B);if(!e)throw new Error("useLimitOrderUi must be used within LimitOrderProvider");return e},A=function(e){var t,r,i=e.fromPairTokenInfo,a=e.toPairTokenInfo,s=e.children,l=(0,O.T)(),c=(0,T.V)(),u=(0,o.Z)(c,2),d=u[0],m=u[1],f=(0,C.gZ)().fetchTokenAccounts;(0,n.useEffect)((function(){d&&m&&f([d.address,m.address])}),[d,m,f]);var x=(0,n.useCallback)((function(e,t){l(e,t)}),[l]);return(0,S.jsx)(B.Provider,{value:{onPairChange:x,fromPairTokenInfo:null!==(t=null!==i&&void 0!==i?i:d)&&void 0!==t?t:F,toPairTokenInfo:null!==(r=null!==a&&void 0!==a?a:m)&&void 0!==r?r:F},children:s})},_=r(6691),D=r(66956),L=r(25546),E=r(76613),K=r(75206),H=r(3011),R=r(39268),q=r.n(R),W=r(54569),z=r(90342),U=r(33130),G=r(49839),J=r(11003),Q=r(85394),Y=r(59394),X=r(78907),$=r(81097),ee=r(78013),te=r(59978),re=r(88381),ne=r(45009),ie=r(24201),ae=r(33986),se=q()((function(){return Promise.all([r.e(2358),r.e(5288),r.e(807)]).then(r.bind(r,50807))}),{ssr:!1,loadableGenerated:{webpack:function(){return[50807]}}}),oe=q()((function(){return r.e(8137).then(r.bind(r,38662))}),{ssr:!1,loadableGenerated:{webpack:function(){return[38662]}}}),le=function(e){var t,r=e.fromPairTokenInfo,i=e.toPairTokenInfo,a=n.useState(!1),s=(0,o.Z)(a,2),c=s[0],d=s[1],f=(0,n.useMemo)((function(){return c?[i,r]:[r,i]}),[r,i,c]),x=f[0],h=f[1],p=(0,ne.a)(["limit-order-chart-and-headers-price",null===x||void 0===x?void 0:x.address,null===h||void 0===h?void 0:h.address,c],(0,l.Z)(u().mark((function e(){var t,r,n,i,a,s,o,l,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Date.now(),r=Math.floor(t/1e3-86400).toString(),n=Math.floor(t/1e3).toString(),i=new URLSearchParams({base_address:x.address,quote_address:h.address,type:"1H",time_from:r,time_to:n}),e.next=6,fetch("https://public-api.birdeye.so/defi/ohlcv/base_quote?".concat(i.toString()),{headers:{"X-API-KEY":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE2NzI5MDEwNzZ9.c66gFnI20ymHoPWapB0JgISzqDIK6Q_Zg0oAVp8Ssyc"}});case 6:return a=e.sent,e.next=9,a.json();case 9:return s=e.sent,o=s.data.items[s.data.items.length-1].c,l=s.data.items[0].c,c=new k.Z(o).minus(l).div(l).mul(100).toDP(2).toNumber(),e.abrupt("return",{currentPrice:o,initialPrice:l,priceChange:c});case 14:case"end":return e.stop()}}),e)}))),{refetchInterval:1e4,refetchIntervalInBackground:!0}).data,v=(0,n.useMemo)((function(){return"".concat(null===x||void 0===x?void 0:x.symbol,"/").concat(null===h||void 0===h?void 0:h.symbol)}),[null===x||void 0===x?void 0:x.symbol,null===h||void 0===h?void 0:h.symbol]),b=(0,n.useMemo)((function(){var e,t=(0,re.p_)(null!==(e=null===p||void 0===p?void 0:p.currentPrice)&&void 0!==e?e:0),r=(0,o.Z)(t,3);r[0],r[1];return r[2].length}),[null===p||void 0===p?void 0:p.currentPrice]);return(0,S.jsxs)(S.Fragment,{children:[null!==p&&void 0!==p&&p.currentPrice?(0,S.jsx)(oe,{tickerName:v,price:null===p||void 0===p?void 0:p.currentPrice,precision:b}):null,(0,S.jsxs)("div",{className:"flex max-h-[100%] rounded-2xl overflow-hidden w-full flex-col justify-between transition-height duration-500 ease-in-out",children:[(0,S.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-0",children:[(0,S.jsxs)("div",{className:"hidden md:flex -space-x-2",children:[(0,S.jsx)(te.Z,{info:x,width:32,height:32}),(0,S.jsx)(te.Z,{info:h,width:32,height:32})]}),(0,S.jsxs)("div",{className:"flex md:hidden -space-x-2",children:[(0,S.jsx)(te.Z,{info:x,width:24,height:24}),(0,S.jsx)(te.Z,{info:h,width:24,height:24})]}),(0,S.jsxs)("div",{className:"flex items-center group cursor-pointer",onClick:function(){return d(!c)},children:[(0,S.jsx)("span",{className:"ml-1.5 md:ml-4 font-semibold max-md:text-xs",children:v}),(0,S.jsx)("div",{className:"ml-2 text-v2-lily/[.75] group-hover:text-v2-primary fill-current",children:(0,S.jsx)(ae.Z,{})})]}),p?(0,S.jsxs)("div",{className:"text-xs lg:text-base flex items-center ml-auto font-semibold space-x-1",children:[(0,S.jsx)(re.ZP,{value:p.currentPrice,maxSuffix:5}),(0,S.jsxs)("span",{className:(0,ie.cn)("!ml-3 leading-none text-xs flex items-center",(null!==(t=null===p||void 0===p?void 0:p.priceChange)&&void 0!==t?t:0)>=0?"text-light-active-state dark:text-v2-primary":"text-orange-600"),children:[(null===p||void 0===p?void 0:p.priceChange)>0?(0,S.jsxs)("span",{className:"flex whitespace-nowrap items-center",children:[(0,S.jsx)("span",{className:"text-xxs",children:"+"}),(0,S.jsx)("span",{className:"text-xs",children:null===p||void 0===p?void 0:p.priceChange})]}):"".concat(null===p||void 0===p?void 0:p.priceChange),"%"]})]}):null]}),(0,S.jsx)(se,{datafeedObject:{baseTokenInfo:x,quoteTokenInfo:h},desktopOverlayExplanation:m.ag._("The graph data is an overview of all on-chain activity. In particular, very sharp wicks might not be filled completely due to insufficient liquidity."),shadesClassName:"!bg-[#131B24]",opt:{showVolume:!0,enableVolumeStudy:!0}})]}),(0,S.jsx)("span",{className:"block lg:hidden text-xs text-white/75 px-4 py-2",children:m.ag._("The graph data is an overview of all on-chain activity. In particular, very sharp wicks might not be filled completely due to insufficient liquidity.")})]})},ce=r(41118),ue=r(55948),de=r(94223),me=r(71052),fe=r(78232),xe=r(77798),he=r(23632),pe=r(68718),ve=r(54566),be=r(70006),ge=r(71130),ke=r(99438),we=r(30610),je=r(12939),ye=r(56100),Pe=r(73413),Ne=r(1622),Ce=r(16330),Ze=r(95523),Ie=r(3561),Me=r(69921),Oe=function(e){return Object.entries(e).reduce((function(e,t){var r=(0,o.Z)(t,2),n=r[0],i=r[1];return"hour"===n?e+=60*i*60:"minute"===n&&(e+=60*i),e}),0)},Te=function(e){var t=e.onSet,r=e.value,i="number"===typeof r?(0,L.K3)(Number(r)):{day:0,hour:0,minute:0},a=i.day,s=i.hour,o=i.minute,l=(0,N.cI)({defaultValues:{hour:(24*a+s).toString(),minute:o.toString()}}),c=l.control,u=l.handleSubmit,m=(0,l.watch)(),f=(0,n.useMemo)((function(){return!m.hour&&!m.minute||0===Number(m.hour)&&0===Number(m.minute)||Oe(m)>31536e4}),[m.hour,m.minute]),x=(0,n.useCallback)((function(e){var r=Oe(e);t(String(r))}),[t]),h=(0,n.useRef)(),p=(0,n.useRef)(),v=(0,n.useCallback)((function(){var e;return null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.focus()}),[]),b=(0,n.useCallback)((function(){var e;return null===p||void 0===p||null===(e=p.current)||void 0===e?void 0:e.focus()}),[]);return(0,S.jsx)("div",{className:"w-full flex justify-center",children:(0,S.jsxs)("form",{className:"p-3 bg-white dark:bg-tuna flex flex-col space-y-3 rounded-xl w-[320px] shadow-lg",onSubmit:u(x),children:[(0,S.jsx)("div",{className:"text-base leading-8 font-semibold",children:(0,S.jsx)(d.cC,{id:"Custom Expiry Period"})}),(0,S.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,S.jsxs)("div",{onClick:v,className:"flex w-full items-center justify-between bg-jupiter-input-light dark:bg-jupiter-input-dark p-4 rounded-xl ",children:[(0,S.jsx)(N.Qr,{control:c,name:"hour",render:function(e){var t=e.field,r=t.onChange,n=t.value,i=t.name;return(0,S.jsx)(Ce.Z,{name:i,className:"!text-left text-sm placeholder:text-black/20 dark:placeholder:text-white/20",placeholder:"0",decimals:0,onChange:r,value:"0"===n?"":n,ref:h})}}),(0,S.jsx)("div",{className:"text-sm text-black/20 dark:text-white/20",children:(0,S.jsx)(d.cC,{id:"Hours"})})]}),(0,S.jsxs)("div",{onClick:b,className:"flex w-full items-center justify-between bg-jupiter-input-light dark:bg-jupiter-input-dark p-4 rounded-xl",children:[(0,S.jsx)(N.Qr,{control:c,name:"minute",render:function(e){var t=e.field,r=t.onChange,n=t.value,i=t.name;return(0,S.jsx)(Ce.Z,{name:i,className:"!text-left text-sm placeholder:text-black/20 dark:placeholder:text-white/20",placeholder:"0",decimals:0,onChange:r,value:"0"===n?"":n,ref:p})}}),(0,S.jsx)("div",{className:"text-sm text-black/20 dark:text-white/20",children:(0,S.jsx)(d.cC,{id:"Minutes"})})]})]}),(0,S.jsx)("button",{type:"submit",disabled:f,className:"font-semibold w-full mt-2 bg-jupiter-navy dark:bg-jupiter-gradient text-white rounded-lg items-center p-px disabled:cursor-not-allowed disabled:opacity-50",children:(0,S.jsx)("div",{className:"flex items-center justify-center px-8 py-4 rounded-lg dark:bg-black",children:(0,S.jsx)("span",{className:"text-center",children:(0,S.jsx)(je.Z,{animate:!1,children:(0,S.jsx)(d.cC,{id:"Set Period"})})})})})]})})},Se=r(46267),Fe=r(59243),Be=function(e){var t=e.fromPairTokenInfo,r=e.toPairTokenInfo,i=e.baseTokenInfo,s=e.quoteTokenInfo,o=e.baseTokenPrice,c=e.quoteTokenPrice,f=e.rateDecimals,x=e.control,h=e.isDisabled,p=e.onSubmit,v=e.setValue,b=e.watchAllFields,g=e.formState,w=e.feeStructure,j=e.isLoadingDasQuery,y=e.tokenHaveTransferFee,M=(0,be.JT)(),O=M.openContextualModal,T=M.ModalContextConsumer,F=M.closeModal,B=M.openModal,A=(0,C.Os)().wallet,_=V().onPairChange,D=(0,n.createRef)(),K=(0,C.Bn)(),H=K.tokenMap,R=K.newTokenListMap,q=(0,n.useState)({day:0,hour:0,minute:0}),W=q[0],z=q[1],U=(0,n.useState)(!1),G=U[0],J=U[1],Y=(0,n.useState)(!1),X=Y[0],$=Y[1],ee=(0,n.useMemo)((function(){return"".concat(W.day?"".concat(W.day,"d"):""," ").concat(W.hour?"".concat(W.hour,"h"):""," ").concat(W.minute?"".concat(W.minute,"m"):"")}),[W]),te=(0,n.useMemo)((function(){if(!ce.d.find((function(e){return e===(null===t||void 0===t?void 0:t.address)||e===(null===r||void 0===r?void 0:r.address)})))return null;var e=b.fromPair===(null===i||void 0===i?void 0:i.address);return{isFromBase:Boolean(e)}}),[null===i||void 0===i?void 0:i.address,null===t||void 0===t?void 0:t.address,null===r||void 0===r?void 0:r.address,b.fromPair]),re=n.useCallback((function(e){var n=e,i=r;r.address===e.address&&(n=r,i=t),$(!1),i&&_(n,i)}),[_,t,r]),ne=n.useCallback((function(e){var n=t,i=e;t.address===e.address&&(n=r,i=t),$(!1),n&&_(n,i)}),[_,t,r]),ae=n.useCallback((function(){_(r,t),v("fromPairValue","1"),$(!1)}),[r,t,_,v]),se=(0,n.useMemo)((function(){return(0,E.Hd)(b.targetPrice)?Number(b.targetPrice):0}),[b.targetPrice]),oe=n.useCallback((function(e){(0,E.Hd)(e)&&v("toPairValue",e)}),[v]),le=(0,xe.E)(),Oe=(0,he.s)({quoteTokenInfo:s,baseTokenInfo:i,quoteTokenPrice:c,baseTokenPrice:o,isBaseQuoteMode:te,rateDecimals:f,isSubmitting:g.isSubmitting}),Be=Oe.swapMarketPrice,Ve=Oe.lastMarketPrice,Ae=Oe.isFetching,_e=Oe.isFetched,De=Boolean(o&&c&&Ve),Le=(0,n.useCallback)((function(e){Be&&De&&(v("targetPrice",Be.toFixed()),oe(null!==te&&void 0!==te&&te.isFromBase?new k.Z(Be.toFixed()).mul(e||0).toDP(f).toFixed():new k.Z(e||0).div(Be).toDP(f).toFixed()))}),[Be,De,v,oe,te,f]),Ee=(0,n.useMemo)((function(){return R.has(s.address)||R.has(i.address)}),[R,s,i]);(0,n.useEffect)((function(){X||(v("targetPrice",""),v("toPairValue",""),Ee||Le(b.fromPairValue))}),[X,Le,Ee]);var Ke=(0,n.useMemo)((function(){var e=new k.Z(0);if(!De||!b.targetPrice||!Ve)return e;var t=new k.Z(se).sub(Ve).div(Ve);return(e=new k.Z(100).mul(t).toDP(2)).isFinite()?e:new k.Z(0)}),[b.targetPrice,Ve,se,De]),He=(0,n.useMemo)((function(){return Ke.gt(1e4)?">10000":"".concat(Ke.toNumber()>0?"+":"").concat(Ke.toDP(2).toString())}),[Ke]),Re=(0,n.useMemo)((function(){return null!==te&&void 0!==te&&te.isFromBase?Ke.toNumber()<0:Ke.toNumber()>0}),[null===te||void 0===te?void 0:te.isFromBase,Ke]),qe=(0,n.useMemo)((function(){return null!==te&&void 0!==te&&te.isFromBase?Ke.toNumber()>0:Ke.toNumber()<0}),[null===te||void 0===te?void 0:te.isFromBase,Ke]),We=(0,n.useMemo)((function(){return!Ae&&(Re||qe)}),[Re,qe,Ae]),ze=(0,n.useMemo)((function(){return null!==te&&void 0!==te&&te.isFromBase?Ke.toNumber()>-5:Ke.toNumber()<5}),[null===te||void 0===te?void 0:te.isFromBase,Ke]),Ue=(0,C.y6)().tokenPriceMap,Ge=(0,n.useMemo)((function(){return!De&&(!_e||!Ae)}),[De,Ae,_e]),Je=(0,n.useMemo)((function(){if(le){if(Ee)return(0,S.jsx)(d.cC,{id:"Due to the new token's high volatility during its price discovery phase, exercise caution when trading. We recommend setting a specific price before placing an order."});if(Ge)return(0,S.jsx)(d.cC,{id:"Could not retrieve market price for this pair. Trade with caution"});var e=(0,S.jsx)(P(),{shallow:!0,href:"/swap/".concat(t.symbol,"-").concat(r.symbol,"?inAmount=").concat(b.fromPairValue),className:"underline font-bold",target:"_blank",children:(0,S.jsx)(d.cC,{id:"Jupiter Swap"})}),n=(0,S.jsx)(d.cC,{id:"Limit price is {0}% {1} than market, you are {2} at a much {3} rate. We recommend that you use {swapLink} instead",values:{0:Ke.absoluteValue(),1:null!==te&&void 0!==te&&te.isFromBase?"lower":"higher",2:null!==te&&void 0!==te&&te.isFromBase?"selling":"buying",3:null!==te&&void 0!==te&&te.isFromBase?"lower":"higher",swapLink:e}});if(null!==te&&void 0!==te&&te.isFromBase){if(Ke.toNumber()<=-.5)return n}else if(Ke.toNumber()>=.5)return n}}),[le,Ee,Ge,t.symbol,r.symbol,b.fromPairValue,Ke,null===te||void 0===te?void 0:te.isFromBase]),Qe=(0,Z.FB)(b.fromPair).balance,Ye=n.useCallback((function(e){var t;e.preventDefault(),t=b.fromPair===I.W4.toBase58()?String(Qe>I.WO?Qe-I.WO:0):String(Qe),v("fromPairValue",t);var r=null!==te&&void 0!==te&&te.isFromBase?se:se?1/se:0;v("toPairValue",new k.Z(t).mul(r).toFixed())}),[b.fromPair,v,null===te||void 0===te?void 0:te.isFromBase,se,Qe]),Xe=n.useCallback((function(e){e.preventDefault();var t=new k.Z(Qe).div(2).toString();v("fromPairValue",t);var r=null!==te&&void 0!==te&&te.isFromBase?se:se?1/se:0;v("toPairValue",new k.Z(t).mul(r).toFixed())}),[null===te||void 0===te?void 0:te.isFromBase,Qe,v,se]),$e=(0,n.useMemo)((function(){if(null===A||void 0===A||!A.adapter.connected)return!1;if((null===t||void 0===t?void 0:t.address)!==I.W4.toBase58())return!1;if(!(0,E.Hd)(b.fromPairValue))return!1;var e=Qe-I.WO;return new k.Z(b.fromPairValue||0).gt(e)}),[null===t||void 0===t?void 0:t.address,Qe,null===A||void 0===A?void 0:A.adapter.connected,b.fromPairValue]),et=(0,n.useMemo)((function(){return new k.Z(b.fromPairValue||0).lte(Qe)}),[Qe,b.fromPairValue]),tt=(0,Pe.useIsAccountFrozen)(t),rt=(0,Pe.useIsAccountFrozen)(r),nt=(0,n.useCallback)((function(){T&&O(Fe.YN,void 0,(0,S.jsx)(T,{children:function(){var e,t;return(0,S.jsx)(Te,{onSet:function(e){v("expiry",e),z((0,L.K3)(Number(e))),F()},value:null!==(e=null===(t=Fe.yn[b.expiry])||void 0===t?void 0:t.name)&&void 0!==e?e:Number(b.expiry)})}}),{position:"center",containerStyle:{background:"none",boxShadow:"none"}})}),[T,b.expiry,O,v,F]),it=(0,n.useMemo)((function(){var e=Fe.CO.includes(t.address)&&Fe.CO.includes(r.address),n=Fe.Jx.includes(t.address)&&Fe.Jx.includes(r.address),i=Fe.OC.includes(t.address)||Fe.OC.includes(r.address);return w.data?e||n||i?new k.Z(w.data.stableFeeBps).div(100).toFixed(1)+"%":new k.Z(w.data.normalFeeBps).div(100).toFixed(1)+"%":null}),[t.address,r.address,w.data]),at=(0,pe.Z)({tokens:[]}),st=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(n){var i,a,s,o,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),i=b.fromPairValue,a=b.targetPrice,s=b.toPairValue,o=i?new k.Z(i).mul(a).toNumber():null,l=new k.Z(i).div(s).toNumber(),B((0,S.jsx)(fe.Z,{quotedRate:l,onConfirm:p,inputAmount:new k.Z(i).toNumber(),outputAmount:new k.Z(s).toNumber(),inputPair:t,outputPair:r,usdRate:o}),{onClose:function(){},containerStyle:{borderRadius:"12px"}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,p,B,r,b]),ot=(0,n.useMemo)((function(){var e=[];if(function(){var r,n=null===(r=Ue[t.address||""])||void 0===r?void 0:r.usd,i=new k.Z(b.fromPairValue||0).mul(n||0);i&&i.mul(1.001).lt(ce.u)&&e.push(m.ag._("Order must meet a minimum of {MINIMUM_LIMIT_ORDER} USD",{MINIMUM_LIMIT_ORDER:ce.u}))}(),(null===y||void 0===y?void 0:y.length)>0){var r=[m.ag._("Token2022 tokens with transfer fee extensions enabled will result in repetitive fees (and can be updated anytime),  please trade other tokens.")].concat((0,a.Z)(y.map((function(e){return(0,S.jsxs)("p",{className:"mt-1",children:["- ",e.symbol," (",e.fee,"%)"]},e.address)}))));e.push(r)}return e}),[t.address,y,Ue,b.fromPairValue]),lt=(0,n.useMemo)((function(){return h||!et||$e||!ze||tt||rt||j||ot.length>0}),[ot.length,et,h,tt,rt,j,$e,ze]);return(0,S.jsxs)("form",{className:"flex flex-col justify-center w-full lg:max-w-[460px] h-auto p-4 dark:bg-v2-background border border-white/5 rounded-t-none md:rounded-t-2xl rounded-2xl shadow-l shadow-xl -mr-[1px]",onSubmit:Ge?st:p,children:[(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex justify-between items-end",children:[(0,S.jsx)("div",{className:"text-black/50 dark:text-white/50 text-sm",children:(0,S.jsx)(d.cC,{id:"You're Selling"})}),(0,S.jsxs)("div",{className:"text-black-25 dark:text-white-25 text-xs flex items-center",children:[(0,S.jsx)("div",{children:(0,S.jsx)(de.Z,{width:12,height:12})}),r.address?(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsxs)("div",{className:"flex item-center ml-1 cursor-pointer dark:hover:text-white-50 hover:text-black-50",onClick:Ye,children:[(0,S.jsx)(Ne.Z,{mintAddress:t.address}),(0,S.jsx)("span",{className:"ml-1",children:t.symbol})]}),(0,S.jsx)(Me.Z,{tokenAddress:t.address,onClickHalf:Xe,onClickMax:Ye})]}):(0,S.jsx)("span",{children:"0.00"})]})]}),(0,S.jsx)("div",{className:"mt-3 border-b border-transparent",children:(0,S.jsx)("div",{className:(0,ie.cn)("p-4 border border-transparent rounded-lg bg-jupiter-input-light dark:bg-v2-background-dark group","focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:(0,S.jsx)(Se.Z,{testId:"fromPair",pair:t,pairName:"fromPairValue",disabled:!1,control:x,onSubmit:re,mintsList:Array.from(H.keys()),modalId:Fe.r$,watchAllFields:b,onChangeCalculate:function(e){var t=(0,E.Hd)(e)?e:0,n=null!==te&&void 0!==te&&te.isFromBase?se:se?1/se:0;v("fromPairValue",t||""),v("toPairValue",new k.Z(t).mul(n).toDP(r.decimals).toFixed())}})})}),(0,S.jsx)(Pe.default,{tokenInfo:t,className:"mt-2"}),$e?(0,S.jsx)(ge.Z,{className:"text-v2-lily/60 text-xs !px-2",message:m.ag._("We recommend having at least {MINIMUM_SOL_BALANCE} SOL for any transaction",{MINIMUM_SOL_BALANCE:I.WO})}):null,(0,S.jsxs)("div",{className:"mt-3 sm:space-x-3 space-y-2 sm:space-y-0 flex-col-reverse sm:flex sm:flex-row mb-2",children:[(0,S.jsxs)("div",{className:(0,ie.cn)("w-full sm:w-[65%] bg-jupiter-input-light dark:bg-v2-background-dark space-y-1 p-4 rounded-lg flex flex-col justify-center","border border-transparent focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,S.jsxs)("div",{className:"flex justify-between",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[i?(0,S.jsxs)("div",{className:"text-black-35 dark:text-white-35 text-xs flex items-center",children:[null!==te&&void 0!==te&&te.isFromBase?(0,S.jsx)(d.cC,{id:"Sell"}):(0,S.jsx)(d.cC,{id:"Buy"})," ",(0,S.jsx)(d.cC,{id:"{0} at rate",values:{0:null===i||void 0===i?void 0:i.symbol}}),Ae?(0,S.jsx)(Q.Z,{className:"ml-1",width:8,height:8}):null]}):(0,S.jsx)(ye.O,{className:"h-4 w-2"}),We?(0,S.jsx)("div",{className:(0,ie.cn)("flex items-center text-xs ml-1 font-medium",{"text-jupiter-yellow":Re,"text-v2-primary":qe}),children:"(".concat(He,"%)")}):null]}),De?(0,S.jsx)("button",{type:"button",className:"dark:text-white-35 dark:hover:text-white-75 text-black-35 hover:text-black text-xxs cursor-pointer underline rounded",onClick:function(){return Le(b.fromPairValue)},children:(0,S.jsx)(d.cC,{id:"Use Market"})}):null]}),(0,S.jsx)(N.Qr,{name:"targetPrice",control:x,render:function(e){var t=e.field,r=t.onChange,n=t.value;return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-end",children:[(0,S.jsx)(Ce.Z,{testId:"targetPrice",decimals:f,onChangeWithoutEffect:function(e){(0,E.Hd)(e)&&oe(null!==te&&void 0!==te&&te.isFromBase?new k.Z(e).mul(b.fromPairValue||0).toDP(f).toFixed():new k.Z(b.fromPairValue||0).div(e).toDP(f).toFixed()),r(e)},onFocus:function(){return $(!0)},value:n,disabled:!1,ref:D,className:"!text-left !text-sm flex-1"}),s?(0,S.jsx)("div",{className:"flex items-center",children:(0,S.jsx)("span",{className:"font-semibold text-sm",children:null===s||void 0===s?void 0:s.symbol})}):(0,S.jsx)(ye.O,{className:"w-11 h-6"})]}),s&&(0,S.jsx)("div",{className:"text-xs text-v2-lily/30",children:(0,S.jsx)(ve.default,{prefix:"\u2248 ",tokenInfo:s,amount:Number(n),maxDecimals:6})})]})}})]}),(0,S.jsxs)("div",{className:(0,ie.cn)("w-full sm:w-[35%] bg-jupiter-input-light dark:bg-v2-background-dark space-y-1 p-4 rounded-lg flex flex-col justify-between","border border-transparent focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,S.jsx)("p",{className:"text-black-35 dark:text-white-35 text-xs",children:(0,S.jsx)(d.cC,{id:"Expiry"})}),(0,S.jsx)(N.Qr,{name:"expiry",control:x,render:function(e){var t,r,n=e.field,i=n.onChange,a=n.value;return(0,S.jsx)(we.Z,{isOpen:G,onClose:function(){return J(!1)},id:"settings-button",placement:"bottom-end",matchWidth:!0,buttonContent:(0,S.jsxs)("button",{type:"button",onClick:function(){return J((function(e){return!e}))},className:"flex justify-between items-center space-x-2 rounded-lg text-left whitespace-nowrap w-full",children:[(0,S.jsx)("span",{className:"leading-[1.5] font-medium text-clip text-sm overflow-hidden flex-1",children:null!==(t=null===(r=Fe.yn[a])||void 0===r?void 0:r.name)&&void 0!==t?t:ee}),(0,S.jsx)("span",{className:"w-3 h-3",children:(0,S.jsx)(ue.Z,{})})]}),popoverContent:(0,S.jsxs)("div",{className:"mt-1 bg-jupiter-light rounded-lg dark:bg-white/10 overflow-hidden text-left whitespace-nowrap",children:[(0,S.jsx)("div",{className:"max-h-52 overflow-y-auto",children:Object.keys(Fe.yn).map((function(e,t){return(0,S.jsx)("button",{type:"button",onClick:function(){i(e),J(!1)},className:"first:pt-3 last:pb-3 w-full flex items-center py-2 pl-4 pr-3 space-x-2 hover:bg-porcelain dark:hover:bg-shark",children:(0,S.jsx)("span",{className:"text-xs leading-[1.5] font-medium",children:Fe.yn[e].name})},e)}))}),(0,S.jsx)("button",{className:"mt-1 py-2 pl-4 pr-3 text-left border-t border-t-white-10 text-xs leading-[1.5] font-medium cursor-pointer hover:bg-porcelain dark:hover:bg-shark w-full",onClick:function(e){e.preventDefault(),J(!1),nt()},children:"Custom"})]}),contentClassName:"!bg-transparent !shadow-none z-50 !w-full"})}})]})]}),(0,S.jsx)("div",{className:(0,ie.cn)("bg-transparent transition-all duration-700 align-bottom",{"opacity-0 h-0":!Boolean(Je),"opacity-100":Boolean(Je)}),children:Je&&(0,S.jsx)("div",{className:(0,ie.cn)("border-yellow-500 bg-yellow-300/25 rounded-lg px-3 border text-yellow-500 transition-all duration-500 text-xs font-medium align-middle py-2"),children:Je})})]}),(0,S.jsxs)("div",{className:"flex flex-col",children:[(0,S.jsxs)("div",{className:(0,ie.cn)("relative flex justify-center",Je?"mt-1":"my-4"),children:[(0,S.jsx)("hr",{className:"absolute w-full border-jupiter-input-light dark:border-[rgba(25,35,45,0.35)] top-[calc(50%-1px)] -z-0"}),(0,S.jsx)("div",{className:"inline-block z-10",children:(0,S.jsx)("button",{type:"button",className:(0,ie.cn)("group/flip bg-[#EBEFF1] dark:bg-v2-background w-8 h-8 rounded-full cursor-pointer flex flex-col justify-center border-[3px] dark:border-[rgba(25,35,45,0.75)] dark:text-white-25","dark:hover:border-v2-primary dark:hover:shadow-swap-input-dark"),onClick:ae,children:(0,S.jsx)("span",{className:"w-full text-white/50 fill-current flex justify-center transition-none group-hover/flip:text-v2-primary/50 dark:group-hover/flip:text-v2-primary",children:(0,S.jsx)(Ze.Z,{})})})})]}),(0,S.jsxs)("div",{className:"border-b border-transparent",children:[(0,S.jsxs)("div",{className:"flex justify-between items-end",children:[(0,S.jsx)("div",{className:"text-black/50 dark:text-white/50 text-sm",children:(0,S.jsx)(d.cC,{id:"You're Buying"})}),(0,S.jsxs)("div",{className:"text-black-25 dark:text-white-25 text-xs flex",children:[(0,S.jsx)("div",{className:"mt-[1px]",children:(0,S.jsx)(de.Z,{width:12,height:12})}),r.address?(0,S.jsxs)("div",{className:"ml-1",children:[(0,S.jsx)(Ne.Z,{mintAddress:r.address}),(0,S.jsx)("span",{className:"ml-1",children:r.symbol})]}):(0,S.jsx)("span",{children:"0.00"})]})]}),(0,S.jsx)("div",{className:"mt-3 border-b border-transparent",children:(0,S.jsx)("div",{className:(0,ie.cn)("p-4 border border-transparent rounded-lg bg-jupiter-input-light dark:bg-v2-background-dark group","focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:(0,S.jsx)(Se.Z,{testId:"toPair",pair:r,pairName:"toPairValue",control:x,onSubmit:ne,mintsList:Array.from(H.keys()),modalId:Fe.re,watchAllFields:b,onChangeCalculate:function(e){var t=(0,E.Hd)(e)?e:0,r=null!==te&&void 0!==te&&te.isFromBase?se:se?1/se:0;v("toPairValue",0===t?"":t),v("fromPairValue",0===t?"0":new k.Z(t).div(r).toFixed())}})})})]}),(0,S.jsx)(Pe.default,{tokenInfo:r,className:"mt-2 !-mb-2"}),(0,S.jsxs)("div",{className:"flex justify-between text-[11px] font-medium mt-3",children:[(0,S.jsx)("p",{className:"text-black-50 dark:text-white-50",children:m.ag._("Platform fee:")}),w.isLoading?(0,S.jsx)(ye.O,{className:"w-20 h-4"}):(0,S.jsx)("p",{className:"ml-1 text-v2-primary",children:it})]}),(0,S.jsxs)("div",{className:"py-3 px-4 text-xs bg-black/15 dark:bg-white/5 text-black/75 dark:text-white/75 border border-black/[.15] dark:border-white/[.15] rounded-lg mt-3",children:[(0,S.jsx)(d.cC,{id:"You will receive exactly what you have specified, minus platform fees."}),(0,S.jsx)("a",{className:"ml-1 underline cursor-pointer",href:"https://station.jup.ag/guides/limit-order/how-lo-work",target:"_blank",children:m.ag._("Learn more")})]}),ot.length>0?(0,S.jsxs)("div",{className:"mt-2 py-3 px-4 rounded-lg text-xs flex items-start text-white space-x-2 w-full bg-[#F04A44]",children:[(0,S.jsx)("div",{className:"h-3 w-3 mt-0.5 fill-current",children:(0,S.jsx)(Ie.Z,{fill:"inherit"})}),(0,S.jsx)("div",{className:"flex flex-col space-y-1",children:ot.map((function(e,t){return(0,S.jsx)("div",{children:e},t)}))})]}):null,null!==A&&void 0!==A&&A.adapter.publicKey?at?(0,S.jsx)(pe.y,{}):(0,S.jsx)("button",{type:"submit",className:(0,ie.cn)("w-full mt-3 bg-[#121D28] border border-transparent dark:hover:border dark:hover:border-v2-primary rounded-lg",{"opacity-50 cursor-not-allowed":lt}),disabled:lt,children:(0,S.jsx)("div",{className:"flex items-center justify-center px-8 py-4 rounded-lg dark:bg-[rgba(18,29,40,1)]",children:(0,S.jsx)("span",{className:"text-center",children:$e||!et?(0,S.jsx)(d.cC,{id:"Insufficient {0}",values:{0:null===t||void 0===t?void 0:t.symbol}}):tt||rt?(0,S.jsx)(d.cC,{id:"Token account frozen"}):(0,S.jsx)(je.Z,{children:g.isSubmitting?(0,S.jsx)(d.cC,{id:"Submitting..."}):(0,S.jsx)(d.cC,{id:"Place Limit Order"})})})})}):(0,S.jsx)(me.uS,{buttonClassName:"!bg-transparent",overrideContent:(0,S.jsx)(ke.Z,{className:"w-full mt-2",size:"md",children:(0,S.jsx)("span",{children:(0,S.jsx)(d.cC,{id:"Connect Wallet"})})})})]})]})},Ve=r(74376),Ae=r(86883),_e=r(84914),De=r(91511);function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}q()((function(){return Promise.resolve().then(r.bind(r,73413))}),{ssr:!1,loadableGenerated:{webpack:function(){return[73413]}}});var Ke={decimals:6,address:"",chainId:101,name:"",symbol:""},He=function(){var e=(0,_.Fg)().mode,t=(0,C.Os)(),r=t.wallet,i=t.signTransaction,s=t.signAllTransactions,c=t.publicKey,p=(0,C.MG)().constants.CLUSTER,b=(0,C.Bn)().connection,w=(0,Z.lm)(),y=w.toast,O=w.close,T=(0,n.useMemo)((function(){return new f.vN(b)}),[b]),F=V(),B=F.fromPairTokenInfo,A=F.toPairTokenInfo,R=(0,n.useState)("Open Orders"),q=R[0],te=R[1],re=(0,n.useState)(0),ne=re[0],ie=re[1];(0,n.useEffect)((function(){ie(0)}),[q]);var ae=(0,Z.aM)([(null===c||void 0===c?void 0:c.toString())||""],(0,l.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return",[]);case 2:return e.t0=Promise,e.next=5,T.getOrders([(0,f.Gt)(c)]);case 5:return e.t1=e.sent,e.next=8,x.AU([(0,f.Gt)(c)],b);case 8:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=12,e.t0.all.call(e.t0,e.t3);case 12:return t=e.sent,e.abrupt("return",t.flat().filter(Boolean));case 14:case"end":return e.stop()}}),e)}))),{enabled:Boolean(c)&&"Open Orders"===q,refetchInterval:!1}),se=ae.data,oe=ae.isFetching,ce=ae.refetch,ue=(0,n.useMemo)((function(){return null!==se&&void 0!==se&&se.length?Math.ceil(se.length/I.eN):0}),[se]),de=(0,n.useMemo)((function(){return se?se.sort((function(e,t){return"createdAt"in e.account===!1?1:"createdAt"in t.account===!1?-1:"createdAt"in e.account&&"createdAt"in t.account?t.account.createdAt.sub(e.account.createdAt).toNumber():0})):[]}),[se]),me=(0,n.useMemo)((function(){return(null===de||void 0===de?void 0:de.slice(ne*I.eN,ne*I.eN+10))||[]}),[ne,de]),fe=De.d.orderWithTradeHistoryWithItemsCount.useQuery({wallet:c?null===c||void 0===c?void 0:c.toString():"",pageIndex:ne},{enabled:Boolean(c)&&"Order History"===q,refetchInterval:!1,refetchOnWindowFocus:!1,keepPreviousData:!0}),xe=fe.data,he=fe.isFetching,pe=fe.refetch,ve=(0,n.useMemo)((function(){return null!==xe&&void 0!==xe&&xe.itemsCount?Math.ceil((null===xe||void 0===xe?void 0:xe.itemsCount)/I.eN):0}),[xe]),be=(0,M.Z0)(p),ge=(0,N.cI)({defaultValues:{fromPair:be.initialFrom,toPair:be.initialTo,fromPairValue:"5",targetPrice:"",toPairValue:"",expiry:"Never"}}),ke=ge.control,we=ge.handleSubmit,je=ge.watch,ye=ge.setValue,Pe=ge.formState,Ne=(0,D.b)(B,A),Ce=Ne.quoteTokenInfo,Ze=Ne.baseTokenInfo,Ie=Ne.quoteTokenPrice,Me=Ne.baseTokenPrice,Oe=Ne.rateDecimals;Ne.priceFetched;(0,n.useEffect)((function(){ye("fromPair",B.address),ye("toPair",A.address),ye("targetPrice",""),ye("toPairValue","")}),[B,A,ye]);var Te=je(),Se=(0,n.useMemo)((function(){var e=Te.fromPair,t=Te.toPair,r=Te.fromPairValue,n=Te.targetPrice,i=Te.toPairValue,a=Te.expiry;return!e||!t||Number(r)<=0||Number(i)<=0||Number(n)<=0||!a||Pe.isSubmitting}),[Te,Pe.isSubmitting]),_e=(0,n.useState)([]),Le=_e[0],He=_e[1],Re=(0,U.R3)(),qe=(0,H.KO)(G.yz),We=(0,o.Z)(qe,1)[0],ze=(0,z.gs)().priorityLevel,Ue=(0,$.j)([B,A]),Ge=Ue.data,Je=Ue.isLoading,Qe=(0,n.useMemo)((function(){return null===Ge||void 0===Ge?void 0:Ge.map((function(e){if(e){var t=(0,X.y)(e);if(null!==t.transferFee)return Ee(Ee({},[B,A].find((function(t){return(null===t||void 0===t?void 0:t.address)===e.id}))),{},{fee:t.transferFee})}return null})).filter(Boolean)}),[B,A,Ge]),Ye=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(t){var n,o,l,c,f,p,g,w,j,y,P,N,Z,I,M,O,T,F,V,_,D,L;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Se&&r&&r.adapter.publicKey&&i&&s){e.next=2;break}return e.abrupt("return");case 2:return l=new(v())(new k.Z(t.fromPairValue).mul(Math.pow(10,B.decimals)).round().toString()),c=new(v())(new k.Z(t.toPairValue).mul(Math.pow(10,A.decimals)).round().toString()),f=null!==(n=null===(o=Fe.yn[t.expiry])||void 0===o?void 0:o.value)&&void 0!==n?n:Number(t.expiry),p="Never"===t.expiry?null:new(v())((new Date).valueOf()/1e3+f),g=h.PublicKey.default,e.prev=7,P=(0,E.kL)(B)||(null===Ge||void 0===Ge||null===(w=Ge.find((function(e){return(null===e||void 0===e?void 0:e.id)===B.address})))||void 0===w?void 0:w.token_info.token_program)===C.nA.toString()?C.nA:K.TOKEN_PROGRAM_ID,N=(0,E.kL)(A)||(null===Ge||void 0===Ge||null===(j=Ge.find((function(e){return(null===e||void 0===e?void 0:e.id)===A.address})))||void 0===j?void 0:j.token_info.token_program)===C.nA.toString()?C.nA:K.TOKEN_PROGRAM_ID,e.next=12,x.D9({params:{uniqueId:new(v())(Math.round(1e6*Math.random())),makingAmount:l,takingAmount:c,expiredAt:p,feeBps:null},maker:r.adapter.publicKey,payer:r.adapter.publicKey,inputMint:new h.PublicKey(t.fromPair),outputMint:new h.PublicKey(t.toPair),inputTokenProgram:P,outputTokenProgram:N,connection:b,wrapAndUnwrapSol:!0});case 12:return Z=e.sent,I=Z.ix,M=Z.orderPubKey,O=Z.cleanupIx,T=Z.setupIxs,g=M,He((function(e){return[].concat((0,a.Z)(e),[{publicKey:g,account:{oriMakingAmount:l,makingAmount:l,takingAmount:c,oriTakingAmount:c,inputMint:new h.PublicKey(t.fromPair),outputMint:new h.PublicKey(t.toPair),expiredAt:p,createdAt:Date.now()/1e3}}])})),e.next=21,b.getLatestBlockhash("confirmed");case 21:return F=e.sent,V=F.blockhash,_=F.lastValidBlockHeight,D=(y=new h.Transaction({feePayer:r.adapter.publicKey,blockhash:V,lastValidBlockHeight:_})).add.apply(y,(0,a.Z)(T).concat([I])),O&&D.add(O),e.next=28,Re(D,{blockhash:V,lastValidBlockHeight:_,idl:x.xO,idlProgramId:x.Rn,skipPreflight:!0},{successMessage:(0,S.jsx)(d.cC,{id:"Limit order placed for {0} {1} @ {2} {3}",values:{0:new k.Z(t.fromPairValue).toDP(2).toString(),1:B.symbol,2:new k.Z(t.toPairValue).toDP(A.decimals).toString(),3:A.symbol}}),submittingMessage:(0,S.jsx)(d.cC,{id:"Placing limit order"}),errorMessage:m.ag._("Failed to create order"),referenceFee:"MEDIUM"===ze?We.loAndDCA:"HIGH"===ze&&We.loAndDCA?1.5*We.loAndDCA:"VERY_HIGH"===ze&&We.loAndDCA?3*We.loAndDCA:void 0,minimumFee:G.uo,requestComputeBudgetLimit:3e5});case 28:if(L=e.sent,L.success){e.next=32;break}throw new Error("Failed to create order");case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(7),console.error(e.t0),He((function(e){return e.filter((function(e){return e.publicKey.toBase58()!==g.toBase58()}))}));case 38:return e.prev=38,setTimeout((function(){ce()}),1e3),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[7,34,38,41]])})));return function(t){return e.apply(this,arguments)}}(),[Se,r,i,s,B,A,Ge,b,Re,ze,We.loAndDCA,ce]);(0,n.useEffect)((function(){He((function(e){return e.filter((function(e){return!Boolean(null===se||void 0===se?void 0:se.find((function(t){return t.publicKey&&e.publicKey.equals(t.publicKey)})))}))}))}),[se,He]);var Xe=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.cancelOrder({owner:t,orderPubKey:r});case 2:return n=e.sent,e.next=5,b.getLatestBlockhash("confirmed");case 5:return i=e.sent,a=i.blockhash,s=i.lastValidBlockHeight,n.feePayer=t,n.recentBlockhash=a,n.lastValidBlockHeight=s,e.next=13,Re(n,{blockhash:a,lastValidBlockHeight:s,idl:f.xO,idlProgramId:f.zy["mainnet-beta"],skipPreflight:!0},{successMessage:(0,S.jsx)(d.cC,{id:"Limit order closed"}),submittingMessage:(0,S.jsx)(d.cC,{id:"Closing limit order"}),errorMessage:(0,S.jsx)(d.cC,{id:"Failed to close order"})});case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[b,Re,T]),$e=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===se||void 0===se?void 0:se.find((function(e){return e.publicKey.equals(r)}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,x.v4({maker:t,order:n,inputTokenProgram:null===n||void 0===n?void 0:n.account.inputTokenProgram,connection:b});case 5:return i=e.sent,a=i.setupIx,s=i.cancelIx,e.abrupt("return",{setupIx:a,cancelIx:s});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[b,se]),et=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(t,r){var n,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getLatestBlockhash("confirmed");case 2:return n=e.sent,i=n.blockhash,a=n.lastValidBlockHeight,s=new h.Transaction({feePayer:t,blockhash:i,lastValidBlockHeight:a}),r.forEach((function(e){e.setupIx&&s.add(e.setupIx),s.add(e.cancelIx)})),e.next=9,Re(s,{blockhash:i,lastValidBlockHeight:a,idl:x.xO,idlProgramId:x.Rn,skipPreflight:!0},{successMessage:(0,S.jsx)(d.cC,{id:"Limit order closed"}),submittingMessage:(0,S.jsx)(d.cC,{id:"Closing limit order"}),errorMessage:(0,S.jsx)(d.cC,{id:"Failed to close order"})});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[b,Re]),tt=(0,n.useCallback)(function(){var e=(0,l.Z)(u().mark((function e(t){var n,o,c,f,x,p,v,k,w,j,P,N,C,Z,I,M,F,B,V,A,_,D;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="cancel-limit-order-toast",o=(0,S.jsx)(S.Fragment,{}),c=[],f=null===r||void 0===r?void 0:r.adapter.publicKey,r&&f&&i&&s&&se&&0!==t.length){e.next=6;break}return e.abrupt("return");case 6:if(!(x=1===t.length?se.find((function(e){return e.publicKey.equals(t[0])})):null)||!x.publicKey){e.next=32;break}if(e.prev=8,!("createdAt"in x.account)){e.next=20;break}return e.next=13,$e(f,x.publicKey);case 13:if(p=e.sent){e.next=16;break}throw new Error("Failed to create to v2 cancel order instruction");case 16:return e.next=18,et(f,[p]);case 18:e.next=22;break;case 20:return e.next=22,Xe(f,x.publicKey);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(8),console.log(e.t0);case 27:return e.prev=27,ce(),e.finish(27);case 30:e.next=70;break;case 32:if(!(t.length>1)){e.next=70;break}return o=(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{children:(0,S.jsx)(d.cC,{id:"Cancelling {0} orders...",values:{0:t.length}})}),t.length>Fe.TC?(0,S.jsx)("p",{children:(0,S.jsx)(d.cC,{id:"Due to transaction size, you may need to approve multiple transactions."})}):null]}),v=t.reduce((function(e,t){var r=null===se||void 0===se?void 0:se.find((function(e){return e.publicKey.equals(t)}));return r?("createdAt"in r.account?e.ordersToCancelV2.push({order:r,orderPubkey:t}):e.ordersToCancelV1.push({order:r,orderPubkey:t}),e):e}),{ordersToCancelV1:[],ordersToCancelV2:[]}),k=v.ordersToCancelV1,w=v.ordersToCancelV2,j=(0,L.OZ)(k,Fe.TC),P=(0,L.OZ)(w,Fe.TC),e.next=39,Promise.all(j.map(function(){var e=(0,l.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.batchCancelOrder({owner:f,ordersPubKey:t.map((function(e){return e.orderPubkey}))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 39:return N=e.sent,e.next=42,Promise.all(P.map(function(){var e=(0,l.Z)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=(0,l.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e(f,t.orderPubkey);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return r=e.sent,n=r.filter(Boolean),i=new h.Transaction,n.forEach((function(e){e.setupIx&&i.add(e.setupIx),i.add(e.cancelIx)})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 42:return C=e.sent.filter(Boolean),e.prev=43,y({duration:12e4,id:n,render:function(e){return(0,S.jsx)(J.ZJ,Ee(Ee({},e),{},{title:m.ag._("Submitting transaction"),description:(0,S.jsx)("div",{children:(0,S.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,S.jsx)(Q.Z,{width:20,height:20}),(0,S.jsx)("div",{children:o})]})})}))},closeOnClick:!1}),Z=[],e.next=48,b.getLatestBlockhash("confirmed");case 48:for(I=e.sent,M=I.blockhash,F=I.lastValidBlockHeight,B=0,V=[].concat((0,a.Z)(N),(0,a.Z)(C));B<V.length;B++)A=V[B],Z.push(new h.Transaction({feePayer:r.adapter.publicKey,blockhash:M,lastValidBlockHeight:F}).add(A));return e.next=54,s(Z);case 54:return _=e.sent,e.next=57,Promise.all(_.map(function(){var e=(0,l.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.signature&&c.push(g().encode(t.signature)),e.next=3,(0,h.sendAndConfirmRawTransaction)(b,t.serialize(),{commitment:"confirmed"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 57:O(n),y({duration:5e3,title:m.ag._("Transaction submitted successfully"),description:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{children:(0,S.jsx)(d.cC,{id:"Limit order cancelled"})}),c.map((function(e,t){return(0,S.jsx)("p",{children:(0,S.jsx)(Y.Z,{txid:e})},t)}))]}),closeOnClick:!1,variant:J.Lb.SUCCESS}),e.next=67;break;case 61:e.prev=61,e.t1=e.catch(43),O(n),D=t.length>1?m.ag._("Failed to cancel some orders"):m.ag._("Failed to cancel order"),y({duration:5e3,title:D,description:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{children:e.t1.message}),c.map((function(e,t){return(0,S.jsx)("p",{children:(0,S.jsx)(Y.Z,{txid:e})},t)}))]}),closeOnClick:!1,variant:J.Lb.INFO}),console.error({err:e.t1});case 67:return e.prev=67,setTimeout((function(){ce()}),2e3),e.finish(67);case 70:case"end":return e.stop()}}),e,null,[[8,24,27,30],[43,61,67,70]])})));return function(t){return e.apply(this,arguments)}}(),[r,i,s,se,$e,et,Xe,ce,T,y,b,O]),rt=(0,n.useMemo)((function(){return!se||0===se.length||"Order History"===q}),[q,se]),nt=(0,n.useCallback)((function(){if(se&&!rt){var e=se.map((function(e){return e.publicKey})).filter(Boolean);tt(e)}}),[rt,se,tt]),it=(0,n.useCallback)((function(){ce(),pe()}),[ce,pe]),at=(0,Z.aM)(["limit-order-fee-structure"],(0,l.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.JK(b);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{}),st=at.data,ot=at.isLoading;return(0,S.jsx)("div",{className:"w-full flex-1 flex flex-col mt-5 md:mt-10",children:(0,S.jsxs)("div",{className:"flex-1 flex flex-col relative h-full",children:[(0,S.jsx)(W.Z,{product:"limit",className:"justify-center"}),(0,S.jsx)("div",{className:"w-full relative flex justify-center lg:px-4 mt-5 md:mt-10 mb-4",children:(0,S.jsxs)("div",{className:"flex flex-col md:max-w-[90vw] xl:max-w-7xl w-full",children:[(0,S.jsxs)("div",{className:"rounded-2xl shadow-xl bg-[#131B24] border-white/5 flex flex-col lg:flex-row justify-center w-full",children:[null!==Ze&&void 0!==Ze&&Ze.address&&null!==Ce&&void 0!==Ce&&Ce.address?(0,S.jsx)(le,{fromPairTokenInfo:Ze,toPairTokenInfo:Ce}):(0,S.jsx)("div",{className:"max-h-[100%] w-full flex-col justify-between overflow-hidden"}),(0,S.jsx)(Be,{fromPairTokenInfo:B,toPairTokenInfo:A,baseTokenInfo:null!==Ze&&void 0!==Ze?Ze:Ke,quoteTokenInfo:null!==Ce&&void 0!==Ce?Ce:Ke,baseTokenPrice:Me,quoteTokenPrice:Ie,rateDecimals:Oe,control:ke,isDisabled:Se,onSubmit:we(Ye),watchAllFields:Te,setValue:ye,formState:Pe,feeStructure:{data:st,isLoading:ot},dasQuery:Ge,isLoadingDasQuery:Je,tokenHaveTransferFee:Qe})]}),(0,S.jsxs)("div",{className:"lg:flex hidden items-center mt-2",children:[(0,S.jsx)("p",{className:"text-black/50 dark:text-white/50 text-xxs",children:"Powered by"}),(0,S.jsx)(P(),{href:"https://birdeye.so/",target:"_blank",rel:"noopener noreferrer",children:e===_.hY.DARK?(0,S.jsx)(j(),{src:"/images/birdeye-dark.png",width:60,height:22,alt:"birdeye"}):(0,S.jsx)(j(),{src:"/images/birdeye-light.png",width:60,height:22,alt:"birdeye"})})]})]})}),(0,S.jsxs)(ee.Z,{tabs:["Open Orders","Order History"],activeTab:q,setActiveTab:te,isLoading:oe||he,cancelAllOrderDisabled:rt,cancelAllOrder:nt,refetch:it,children:["Open Orders"===q?(0,S.jsx)(Ve.Z,{orders:me,cancelOrder:tt,ongoingSubmission:Le,loading:oe,pageIndex:ne,setPageIndex:ie,pageCount:ue}):null,"Order History"===q?(0,S.jsx)(Ae.Z,{orders:(null===xe||void 0===xe?void 0:xe.orders)||[],loading:he,pageIndex:ne,setPageIndex:ie,pageCount:ve}):null]})]})})},Re=function(){return(0,S.jsx)(_e.ZP,{children:(0,S.jsx)(He,{})})},qe=r(68586),We=!0,ze=function(){return(0,S.jsxs)(A,{children:[(0,S.jsx)(qe.PB,{title:"Limit Order"}),(0,S.jsx)(i.Z,{children:(0,S.jsx)(Re,{})})]})}},60569:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/limit/[inOut]",function(){return r(29151)}])}},function(e){e.O(0,[4508,9603,4931,4277,9438,3215,7369,7821,7375,4518,3073,6353,1237,4300,3380,2029,362,9774,2888,179],(function(){return t=60569,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=[inOut]-2a2dd61bbeca2912.js.map